
/**
 * State-based routing for AngularJS
 * @version v0.2.18
 * @link http://angular-ui.github.com/
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"undefined" != typeof module && "undefined" != typeof exports && module.exports === exports && (module.exports = "ui.router"), function (a, b, c) {
    "use strict"; function d(a, b) { return R(new (R(function () { }, { prototype: a })), b) } function e(a) { return Q(arguments, function (b) { b !== a && Q(b, function (b, c) { a.hasOwnProperty(c) || (a[c] = b) }) }), a } function f(a, b) { var c = []; for (var d in a.path) { if (a.path[d] !== b.path[d]) break; c.push(a.path[d]) } return c } function g(a) { if (Object.keys) return Object.keys(a); var b = []; return Q(a, function (a, c) { b.push(c) }), b } function h(a, b) { if (Array.prototype.indexOf) return a.indexOf(b, Number(arguments[2]) || 0); var c = a.length >>> 0, d = Number(arguments[2]) || 0; for (d = 0 > d ? Math.ceil(d) : Math.floor(d), 0 > d && (d += c) ; c > d; d++) if (d in a && a[d] === b) return d; return -1 } function i(a, b, c, d) { var e, i = f(c, d), j = {}, k = []; for (var l in i) if (i[l] && i[l].params && (e = g(i[l].params), e.length)) for (var m in e) h(k, e[m]) >= 0 || (k.push(e[m]), j[e[m]] = a[e[m]]); return R({}, j, b) } function j(a, b, c) { if (!c) { c = []; for (var d in a) c.push(d) } for (var e = 0; e < c.length; e++) { var f = c[e]; if (a[f] != b[f]) return !1 } return !0 } function k(a, b) { var c = {}; return Q(a, function (a) { c[a] = b[a] }), c } function l(a) { var b = {}, c = Array.prototype.concat.apply(Array.prototype, Array.prototype.slice.call(arguments, 1)); return Q(c, function (c) { c in a && (b[c] = a[c]) }), b } function m(a) { var b = {}, c = Array.prototype.concat.apply(Array.prototype, Array.prototype.slice.call(arguments, 1)); for (var d in a) -1 == h(c, d) && (b[d] = a[d]); return b } function n(a, b) { var c = P(a), d = c ? [] : {}; return Q(a, function (a, e) { b(a, e) && (d[c ? d.length : e] = a) }), d } function o(a, b) { var c = P(a) ? [] : {}; return Q(a, function (a, d) { c[d] = b(a, d) }), c } function p(a, b) { var d = 1, f = 2, i = {}, j = [], k = i, l = R(a.when(i), { $$promises: i, $$values: i }); this.study = function (i) { function n(a, c) { if (s[c] !== f) { if (r.push(c), s[c] === d) throw r.splice(0, h(r, c)), new Error("Cyclic dependency: " + r.join(" -> ")); if (s[c] = d, N(a)) q.push(c, [function () { return b.get(a) }], j); else { var e = b.annotate(a); Q(e, function (a) { a !== c && i.hasOwnProperty(a) && n(i[a], a) }), q.push(c, a, e) } r.pop(), s[c] = f } } function o(a) { return O(a) && a.then && a.$$promises } if (!O(i)) throw new Error("'invocables' must be an object"); var p = g(i || {}), q = [], r = [], s = {}; return Q(i, n), i = r = s = null, function (d, f, g) { function h() { --u || (v || e(t, f.$$values), r.$$values = t, r.$$promises = r.$$promises || !0, delete r.$$inheritedValues, n.resolve(t)) } function i(a) { r.$$failure = a, n.reject(a) } function j(c, e, f) { function j(a) { l.reject(a), i(a) } function k() { if (!L(r.$$failure)) try { l.resolve(b.invoke(e, g, t)), l.promise.then(function (a) { t[c] = a, h() }, j) } catch (a) { j(a) } } var l = a.defer(), m = 0; Q(f, function (a) { s.hasOwnProperty(a) && !d.hasOwnProperty(a) && (m++, s[a].then(function (b) { t[a] = b, --m || k() }, j)) }), m || k(), s[c] = l.promise } if (o(d) && g === c && (g = f, f = d, d = null), d) { if (!O(d)) throw new Error("'locals' must be an object") } else d = k; if (f) { if (!o(f)) throw new Error("'parent' must be a promise returned by $resolve.resolve()") } else f = l; var n = a.defer(), r = n.promise, s = r.$$promises = {}, t = R({}, d), u = 1 + q.length / 3, v = !1; if (L(f.$$failure)) return i(f.$$failure), r; f.$$inheritedValues && e(t, m(f.$$inheritedValues, p)), R(s, f.$$promises), f.$$values ? (v = e(t, m(f.$$values, p)), r.$$inheritedValues = m(f.$$values, p), h()) : (f.$$inheritedValues && (r.$$inheritedValues = m(f.$$inheritedValues, p)), f.then(h, i)); for (var w = 0, x = q.length; x > w; w += 3) d.hasOwnProperty(q[w]) ? h() : j(q[w], q[w + 1], q[w + 2]); return r } }, this.resolve = function (a, b, c, d) { return this.study(a)(b, c, d) } } function q(a, b, c) { this.fromConfig = function (a, b, c) { return L(a.template) ? this.fromString(a.template, b) : L(a.templateUrl) ? this.fromUrl(a.templateUrl, b) : L(a.templateProvider) ? this.fromProvider(a.templateProvider, b, c) : null }, this.fromString = function (a, b) { return M(a) ? a(b) : a }, this.fromUrl = function (c, d) { return M(c) && (c = c(d)), null == c ? null : a.get(c, {}, { cache: b, headers: { Accept: "text/html" } }).then(function (a) { return a.data }) }, this.fromProvider = function (a, b, d) { return c.invoke(a, null, d || { params: b }) } } function r(a, b, e) { function f(b, c, d, e) { if (q.push(b), o[b]) return o[b]; if (!/^\w+([-.]+\w+)*(?:\[\])?$/.test(b)) throw new Error("Invalid parameter name '" + b + "' in pattern '" + a + "'"); if (p[b]) throw new Error("Duplicate parameter name '" + b + "' in pattern '" + a + "'"); return p[b] = new U.Param(b, c, d, e), p[b] } function g(a, b, c, d) { var e = ["", ""], f = a.replace(/[\\\[\]\^$*+?.()|{}]/g, "\\$&"); if (!b) return f; switch (c) { case !1: e = ["(", ")" + (d ? "?" : "")]; break; case !0: f = f.replace(/\/$/, ""), e = ["(?:/(", ")|/)?"]; break; default: e = ["(" + c + "|", ")?"] } return f + e[0] + b + e[1] } function h(e, f) { var g, h, i, j, k; return g = e[2] || e[3], k = b.params[g], i = a.substring(m, e.index), h = f ? e[4] : e[4] || ("*" == e[1] ? ".*" : null), h && (j = U.type(h) || d(U.type("string"), { pattern: new RegExp(h, b.caseInsensitive ? "i" : c) })), { id: g, regexp: h, segment: i, type: j, cfg: k } } b = R({ params: {} }, O(b) ? b : {}); var i, j = /([:*])([\w\[\]]+)|\{([\w\[\]]+)(?:\:\s*((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g, k = /([:]?)([\w\[\].-]+)|\{([\w\[\].-]+)(?:\:\s*((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g, l = "^", m = 0, n = this.segments = [], o = e ? e.params : {}, p = this.params = e ? e.params.$$new() : new U.ParamSet, q = []; this.source = a; for (var r, s, t; (i = j.exec(a)) && (r = h(i, !1), !(r.segment.indexOf("?") >= 0)) ;) s = f(r.id, r.type, r.cfg, "path"), l += g(r.segment, s.type.pattern.source, s.squash, s.isOptional), n.push(r.segment), m = j.lastIndex; t = a.substring(m); var u = t.indexOf("?"); if (u >= 0) { var v = this.sourceSearch = t.substring(u); if (t = t.substring(0, u), this.sourcePath = a.substring(0, m + u), v.length > 0) for (m = 0; i = k.exec(v) ;) r = h(i, !0), s = f(r.id, r.type, r.cfg, "search"), m = j.lastIndex } else this.sourcePath = a, this.sourceSearch = ""; l += g(t) + (b.strict === !1 ? "/?" : "") + "$", n.push(t), this.regexp = new RegExp(l, b.caseInsensitive ? "i" : c), this.prefix = n[0], this.$$paramNames = q } function s(a) { R(this, a) } function t() { function a(a) { return null != a ? a.toString().replace(/~/g, "~~").replace(/\//g, "~2F") : a } function e(a) { return null != a ? a.toString().replace(/~2F/g, "/").replace(/~~/g, "~") : a } function f() { return { strict: p, caseInsensitive: m } } function i(a) { return M(a) || P(a) && M(a[a.length - 1]) } function j() { for (; w.length;) { var a = w.shift(); if (a.pattern) throw new Error("You cannot override a type's .pattern at runtime."); b.extend(u[a.name], l.invoke(a.def)) } } function k(a) { R(this, a || {}) } U = this; var l, m = !1, p = !0, q = !1, u = {}, v = !0, w = [], x = { string: { encode: a, decode: e, is: function (a) { return null == a || !L(a) || "string" == typeof a }, pattern: /[^\/]*/ }, "int": { encode: a, decode: function (a) { return parseInt(a, 10) }, is: function (a) { return L(a) && this.decode(a.toString()) === a }, pattern: /\d+/ }, bool: { encode: function (a) { return a ? 1 : 0 }, decode: function (a) { return 0 !== parseInt(a, 10) }, is: function (a) { return a === !0 || a === !1 }, pattern: /0|1/ }, date: { encode: function (a) { return this.is(a) ? [a.getFullYear(), ("0" + (a.getMonth() + 1)).slice(-2), ("0" + a.getDate()).slice(-2)].join("-") : c }, decode: function (a) { if (this.is(a)) return a; var b = this.capture.exec(a); return b ? new Date(b[1], b[2] - 1, b[3]) : c }, is: function (a) { return a instanceof Date && !isNaN(a.valueOf()) }, equals: function (a, b) { return this.is(a) && this.is(b) && a.toISOString() === b.toISOString() }, pattern: /[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])/, capture: /([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])/ }, json: { encode: b.toJson, decode: b.fromJson, is: b.isObject, equals: b.equals, pattern: /[^\/]*/ }, any: { encode: b.identity, decode: b.identity, equals: b.equals, pattern: /.*/ } }; t.$$getDefaultValue = function (a) { if (!i(a.value)) return a.value; if (!l) throw new Error("Injectable functions cannot be called at configuration time"); return l.invoke(a.value) }, this.caseInsensitive = function (a) { return L(a) && (m = a), m }, this.strictMode = function (a) { return L(a) && (p = a), p }, this.defaultSquashPolicy = function (a) { if (!L(a)) return q; if (a !== !0 && a !== !1 && !N(a)) throw new Error("Invalid squash policy: " + a + ". Valid policies: false, true, arbitrary-string"); return q = a, a }, this.compile = function (a, b) { return new r(a, R(f(), b)) }, this.isMatcher = function (a) { if (!O(a)) return !1; var b = !0; return Q(r.prototype, function (c, d) { M(c) && (b = b && L(a[d]) && M(a[d])) }), b }, this.type = function (a, b, c) { if (!L(b)) return u[a]; if (u.hasOwnProperty(a)) throw new Error("A type named '" + a + "' has already been defined."); return u[a] = new s(R({ name: a }, b)), c && (w.push({ name: a, def: c }), v || j()), this }, Q(x, function (a, b) { u[b] = new s(R({ name: b }, a)) }), u = d(u, {}), this.$get = ["$injector", function (a) { return l = a, v = !1, j(), Q(x, function (a, b) { u[b] || (u[b] = new s(a)) }), this }], this.Param = function (a, d, e, f) { function j(a) { var b = O(a) ? g(a) : [], c = -1 === h(b, "value") && -1 === h(b, "type") && -1 === h(b, "squash") && -1 === h(b, "array"); return c && (a = { value: a }), a.$$fn = i(a.value) ? a.value : function () { return a.value }, a } function k(c, d, e) { if (c.type && d) throw new Error("Param '" + a + "' has two type configurations."); return d ? d : c.type ? b.isString(c.type) ? u[c.type] : c.type instanceof s ? c.type : new s(c.type) : "config" === e ? u.any : u.string } function m() { var b = { array: "search" === f ? "auto" : !1 }, c = a.match(/\[\]$/) ? { array: !0 } : {}; return R(b, c, e).array } function p(a, b) { var c = a.squash; if (!b || c === !1) return !1; if (!L(c) || null == c) return q; if (c === !0 || N(c)) return c; throw new Error("Invalid squash policy: '" + c + "'. Valid policies: false, true, or arbitrary string") } function r(a, b, d, e) { var f, g, i = [{ from: "", to: d || b ? c : "" }, { from: null, to: d || b ? c : "" }]; return f = P(a.replace) ? a.replace : [], N(e) && f.push({ from: e, to: c }), g = o(f, function (a) { return a.from }), n(i, function (a) { return -1 === h(g, a.from) }).concat(f) } function t() { if (!l) throw new Error("Injectable functions cannot be called at configuration time"); var a = l.invoke(e.$$fn); if (null !== a && a !== c && !x.type.is(a)) throw new Error("Default value (" + a + ") for parameter '" + x.id + "' is not an instance of Type (" + x.type.name + ")"); return a } function v(a) { function b(a) { return function (b) { return b.from === a } } function c(a) { var c = o(n(x.replace, b(a)), function (a) { return a.to }); return c.length ? c[0] : a } return a = c(a), L(a) ? x.type.$normalize(a) : t() } function w() { return "{Param:" + a + " " + d + " squash: '" + A + "' optional: " + z + "}" } var x = this; e = j(e), d = k(e, d, f); var y = m(); d = y ? d.$asArray(y, "search" === f) : d, "string" !== d.name || y || "path" !== f || e.value !== c || (e.value = ""); var z = e.value !== c, A = p(e, z), B = r(e, y, z, A); R(this, { id: a, type: d, location: f, array: y, squash: A, replace: B, isOptional: z, value: v, dynamic: c, config: e, toString: w }) }, k.prototype = { $$new: function () { return d(this, R(new k, { $$parent: this })) }, $$keys: function () { for (var a = [], b = [], c = this, d = g(k.prototype) ; c;) b.push(c), c = c.$$parent; return b.reverse(), Q(b, function (b) { Q(g(b), function (b) { -1 === h(a, b) && -1 === h(d, b) && a.push(b) }) }), a }, $$values: function (a) { var b = {}, c = this; return Q(c.$$keys(), function (d) { b[d] = c[d].value(a && a[d]) }), b }, $$equals: function (a, b) { var c = !0, d = this; return Q(d.$$keys(), function (e) { var f = a && a[e], g = b && b[e]; d[e].type.equals(f, g) || (c = !1) }), c }, $$validates: function (a) { var d, e, f, g, h, i = this.$$keys(); for (d = 0; d < i.length && (e = this[i[d]], f = a[i[d]], f !== c && null !== f || !e.isOptional) ; d++) { if (g = e.type.$normalize(f), !e.type.is(g)) return !1; if (h = e.type.encode(g), b.isString(h) && !e.type.pattern.exec(h)) return !1 } return !0 }, $$parent: c }, this.ParamSet = k } function u(a, d) { function e(a) { var b = /^\^((?:\\[^a-zA-Z0-9]|[^\\\[\]\^$*+?.()|{}]+)*)/.exec(a.source); return null != b ? b[1].replace(/\\(.)/g, "$1") : "" } function f(a, b) { return a.replace(/\$(\$|\d{1,2})/, function (a, c) { return b["$" === c ? 0 : Number(c)] }) } function g(a, b, c) { if (!c) return !1; var d = a.invoke(b, b, { $match: c }); return L(d) ? d : !0 } function h(d, e, f, g, h) { function m(a, b, c) { return "/" === q ? a : b ? q.slice(0, -1) + a : c ? q.slice(1) + a : a } function n(a) { function b(a) { var b = a(f, d); return b ? (N(b) && d.replace().url(b), !0) : !1 } if (!a || !a.defaultPrevented) { p && d.url() === p; p = c; var e, g = j.length; for (e = 0; g > e; e++) if (b(j[e])) return; k && b(k) } } function o() { return i = i || e.$on("$locationChangeSuccess", n) } var p, q = g.baseHref(), r = d.url(); return l || o(), { sync: function () { n() }, listen: function () { return o() }, update: function (a) { return a ? void (r = d.url()) : void (d.url() !== r && (d.url(r), d.replace())) }, push: function (a, b, e) { var f = a.format(b || {}); null !== f && b && b["#"] && (f += "#" + b["#"]), d.url(f), p = e && e.$$avoidResync ? d.url() : c, e && e.replace && d.replace() }, href: function (c, e, f) { if (!c.validates(e)) return null; var g = a.html5Mode(); b.isObject(g) && (g = g.enabled), g = g && h.history; var i = c.format(e); if (f = f || {}, g || null === i || (i = "#" + a.hashPrefix() + i), null !== i && e && e["#"] && (i += "#" + e["#"]), i = m(i, g, f.absolute), !f.absolute || !i) return i; var j = !g && i ? "/" : "", k = d.port(); return k = 80 === k || 443 === k ? "" : ":" + k, [d.protocol(), "://", d.host(), k, j, i].join("") } } } var i, j = [], k = null, l = !1; this.rule = function (a) { if (!M(a)) throw new Error("'rule' must be a function"); return j.push(a), this }, this.otherwise = function (a) { if (N(a)) { var b = a; a = function () { return b } } else if (!M(a)) throw new Error("'rule' must be a function"); return k = a, this }, this.when = function (a, b) { var c, h = N(b); if (N(a) && (a = d.compile(a)), !h && !M(b) && !P(b)) throw new Error("invalid 'handler' in when()"); var i = { matcher: function (a, b) { return h && (c = d.compile(b), b = ["$match", function (a) { return c.format(a) }]), R(function (c, d) { return g(c, b, a.exec(d.path(), d.search())) }, { prefix: N(a.prefix) ? a.prefix : "" }) }, regex: function (a, b) { if (a.global || a.sticky) throw new Error("when() RegExp must not be global or sticky"); return h && (c = b, b = ["$match", function (a) { return f(c, a) }]), R(function (c, d) { return g(c, b, a.exec(d.path())) }, { prefix: e(a) }) } }, j = { matcher: d.isMatcher(a), regex: a instanceof RegExp }; for (var k in j) if (j[k]) return this.rule(i[k](a, b)); throw new Error("invalid 'what' in when()") }, this.deferIntercept = function (a) { a === c && (a = !0), l = a }, this.$get = h, h.$inject = ["$location", "$rootScope", "$injector", "$browser", "$sniffer"] } function v(a, e) { function f(a) { return 0 === a.indexOf(".") || 0 === a.indexOf("^") } function m(a, b) { if (!a) return c; var d = N(a), e = d ? a : a.name, g = f(e); if (g) { if (!b) throw new Error("No reference point given for path '" + e + "'"); b = m(b); for (var h = e.split("."), i = 0, j = h.length, k = b; j > i; i++) if ("" !== h[i] || 0 !== i) { if ("^" !== h[i]) break; if (!k.parent) throw new Error("Path '" + e + "' not valid for state '" + b.name + "'"); k = k.parent } else k = b; h = h.slice(i).join("."), e = k.name + (k.name && h ? "." : "") + h } var l = z[e]; return !l || !d && (d || l !== a && l.self !== a) ? c : l } function n(a, b) { A[a] || (A[a] = []), A[a].push(b) } function p(a) { for (var b = A[a] || []; b.length;) q(b.shift()) } function q(b) { b = d(b, { self: b, resolve: b.resolve || {}, toString: function () { return this.name } }); var c = b.name; if (!N(c) || c.indexOf("@") >= 0) throw new Error("State must have a valid name"); if (z.hasOwnProperty(c)) throw new Error("State '" + c + "' is already defined"); var e = -1 !== c.indexOf(".") ? c.substring(0, c.lastIndexOf(".")) : N(b.parent) ? b.parent : O(b.parent) && N(b.parent.name) ? b.parent.name : ""; if (e && !z[e]) return n(e, b.self); for (var f in C) M(C[f]) && (b[f] = C[f](b, C.$delegates[f])); return z[c] = b, !b[B] && b.url && a.when(b.url, ["$match", "$stateParams", function (a, c) { y.$current.navigable == b && j(a, c) || y.transitionTo(b, a, { inherit: !0, location: !1 }) }]), p(c), b } function r(a) { return a.indexOf("*") > -1 } function s(a) { for (var b = a.split("."), c = y.$current.name.split("."), d = 0, e = b.length; e > d; d++) "*" === b[d] && (c[d] = "*"); return "**" === b[0] && (c = c.slice(h(c, b[1])), c.unshift("**")), "**" === b[b.length - 1] && (c.splice(h(c, b[b.length - 2]) + 1, Number.MAX_VALUE), c.push("**")), b.length != c.length ? !1 : c.join("") === b.join("") } function t(a, b) { return N(a) && !L(b) ? C[a] : M(b) && N(a) ? (C[a] && !C.$delegates[a] && (C.$delegates[a] = C[a]), C[a] = b, this) : this } function u(a, b) { return O(a) ? b = a : b.name = a, q(b), this } function v(a, e, f, h, l, n, p, q, t) { function u(b, c, d, f) { var g = a.$broadcast("$stateNotFound", b, c, d); if (g.defaultPrevented) return p.update(), D; if (!g.retry) return null; if (f.$retry) return p.update(), E; var h = y.transition = e.when(g.retry); return h.then(function () { return h !== y.transition ? A : (b.options.$retry = !0, y.transitionTo(b.to, b.toParams, b.options)) }, function () { return D }), p.update(), h } function v(a, c, d, g, i, j) { function m() { var c = []; return Q(a.views, function (d, e) { var g = d.resolve && d.resolve !== a.resolve ? d.resolve : {}; g.$template = [function () { return f.load(e, { view: d, locals: i.globals, params: n, notify: j.notify }) || "" }], c.push(l.resolve(g, i.globals, i.resolve, a).then(function (c) { if (M(d.controllerProvider) || P(d.controllerProvider)) { var f = b.extend({}, g, i.globals); c.$$controller = h.invoke(d.controllerProvider, null, f) } else c.$$controller = d.controller; c.$$state = a, c.$$controllerAs = d.controllerAs, i[e] = c })) }), e.all(c).then(function () { return i.globals }) } var n = d ? c : k(a.params.$$keys(), c), o = { $stateParams: n }; i.resolve = l.resolve(a.resolve, o, i.resolve, a); var p = [i.resolve.then(function (a) { i.globals = a })]; return g && p.push(g), e.all(p).then(m).then(function (a) { return i }) } var A = e.reject(new Error("transition superseded")), C = e.reject(new Error("transition prevented")), D = e.reject(new Error("transition aborted")), E = e.reject(new Error("transition failed")); return x.locals = { resolve: null, globals: { $stateParams: {} } }, y = { params: {}, current: x.self, $current: x, transition: null }, y.reload = function (a) { return y.transitionTo(y.current, n, { reload: a || !0, inherit: !1, notify: !0 }) }, y.go = function (a, b, c) { return y.transitionTo(a, b, R({ inherit: !0, relative: y.$current }, c)) }, y.transitionTo = function (b, c, f) { c = c || {}, f = R({ location: !0, inherit: !1, relative: null, notify: !0, reload: !1, $retry: !1 }, f || {}); var g, j = y.$current, l = y.params, o = j.path, q = m(b, f.relative), r = c["#"]; if (!L(q)) { var s = { to: b, toParams: c, options: f }, t = u(s, j.self, l, f); if (t) return t; if (b = s.to, c = s.toParams, f = s.options, q = m(b, f.relative), !L(q)) { if (!f.relative) throw new Error("No such state '" + b + "'"); throw new Error("Could not resolve '" + b + "' from state '" + f.relative + "'") } } if (q[B]) throw new Error("Cannot transition to abstract state '" + b + "'"); if (f.inherit && (c = i(n, c || {}, y.$current, q)), !q.params.$$validates(c)) return E; c = q.params.$$values(c), b = q; var z = b.path, D = 0, F = z[D], G = x.locals, H = []; if (f.reload) { if (N(f.reload) || O(f.reload)) { if (O(f.reload) && !f.reload.name) throw new Error("Invalid reload state object"); var I = f.reload === !0 ? o[0] : m(f.reload); if (f.reload && !I) throw new Error("No such reload state '" + (N(f.reload) ? f.reload : f.reload.name) + "'"); for (; F && F === o[D] && F !== I;) G = H[D] = F.locals, D++, F = z[D] } } else for (; F && F === o[D] && F.ownParams.$$equals(c, l) ;) G = H[D] = F.locals, D++, F = z[D]; if (w(b, c, j, l, G, f)) return r && (c["#"] = r), y.params = c, S(y.params, n), S(k(b.params.$$keys(), n), b.locals.globals.$stateParams), f.location && b.navigable && b.navigable.url && (p.push(b.navigable.url, c, { $$avoidResync: !0, replace: "replace" === f.location }), p.update(!0)), y.transition = null, e.when(y.current); if (c = k(b.params.$$keys(), c || {}), r && (c["#"] = r), f.notify && a.$broadcast("$stateChangeStart", b.self, c, j.self, l, f).defaultPrevented) return a.$broadcast("$stateChangeCancel", b.self, c, j.self, l), null == y.transition && p.update(), C; for (var J = e.when(G), K = D; K < z.length; K++, F = z[K]) G = H[K] = d(G), J = v(F, c, F === b, J, G, f); var M = y.transition = J.then(function () { var d, e, g; if (y.transition !== M) return A; for (d = o.length - 1; d >= D; d--) g = o[d], g.self.onExit && h.invoke(g.self.onExit, g.self, g.locals.globals), g.locals = null; for (d = D; d < z.length; d++) e = z[d], e.locals = H[d], e.self.onEnter && h.invoke(e.self.onEnter, e.self, e.locals.globals); return y.transition !== M ? A : (y.$current = b, y.current = b.self, y.params = c, S(y.params, n), y.transition = null, f.location && b.navigable && p.push(b.navigable.url, b.navigable.locals.globals.$stateParams, { $$avoidResync: !0, replace: "replace" === f.location }), f.notify && a.$broadcast("$stateChangeSuccess", b.self, c, j.self, l), p.update(!0), y.current) }, function (d) { return y.transition !== M ? A : (y.transition = null, g = a.$broadcast("$stateChangeError", b.self, c, j.self, l, d), g.defaultPrevented || p.update(), e.reject(d)) }); return M }, y.is = function (a, b, d) { d = R({ relative: y.$current }, d || {}); var e = m(a, d.relative); return L(e) ? y.$current !== e ? !1 : b ? j(e.params.$$values(b), n) : !0 : c }, y.includes = function (a, b, d) { if (d = R({ relative: y.$current }, d || {}), N(a) && r(a)) { if (!s(a)) return !1; a = y.$current.name } var e = m(a, d.relative); return L(e) ? L(y.$current.includes[e.name]) ? b ? j(e.params.$$values(b), n, g(b)) : !0 : !1 : c }, y.href = function (a, b, d) { d = R({ lossy: !0, inherit: !0, absolute: !1, relative: y.$current }, d || {}); var e = m(a, d.relative); if (!L(e)) return null; d.inherit && (b = i(n, b || {}, y.$current, e)); var f = e && d.lossy ? e.navigable : e; return f && f.url !== c && null !== f.url ? p.href(f.url, k(e.params.$$keys().concat("#"), b || {}), { absolute: d.absolute }) : null }, y.get = function (a, b) { if (0 === arguments.length) return o(g(z), function (a) { return z[a].self }); var c = m(a, b || y.$current); return c && c.self ? c.self : null }, y } function w(a, b, c, d, e, f) { function g(a, b, c) { function d(b) { return "search" != a.params[b].location } var e = a.params.$$keys().filter(d), f = l.apply({}, [a.params].concat(e)), g = new U.ParamSet(f); return g.$$equals(b, c) } return !f.reload && a === c && (e === c.locals || a.self.reloadOnSearch === !1 && g(c, d, b)) ? !0 : void 0 } var x, y, z = {}, A = {}, B = "abstract", C = { parent: function (a) { if (L(a.parent) && a.parent) return m(a.parent); var b = /^(.+)\.[^.]+$/.exec(a.name); return b ? m(b[1]) : x }, data: function (a) { return a.parent && a.parent.data && (a.data = a.self.data = d(a.parent.data, a.data)), a.data }, url: function (a) { var b = a.url, c = { params: a.params || {} }; if (N(b)) return "^" == b.charAt(0) ? e.compile(b.substring(1), c) : (a.parent.navigable || x).url.concat(b, c); if (!b || e.isMatcher(b)) return b; throw new Error("Invalid url '" + b + "' in state '" + a + "'") }, navigable: function (a) { return a.url ? a : a.parent ? a.parent.navigable : null }, ownParams: function (a) { var b = a.url && a.url.params || new U.ParamSet; return Q(a.params || {}, function (a, c) { b[c] || (b[c] = new U.Param(c, null, a, "config")) }), b }, params: function (a) { var b = l(a.ownParams, a.ownParams.$$keys()); return a.parent && a.parent.params ? R(a.parent.params.$$new(), b) : new U.ParamSet }, views: function (a) { var b = {}; return Q(L(a.views) ? a.views : { "": a }, function (c, d) { d.indexOf("@") < 0 && (d += "@" + a.parent.name), b[d] = c }), b }, path: function (a) { return a.parent ? a.parent.path.concat(a) : [] }, includes: function (a) { var b = a.parent ? R({}, a.parent.includes) : {}; return b[a.name] = !0, b }, $delegates: {} }; x = q({ name: "", url: "^", views: null, "abstract": !0 }), x.navigable = null, this.decorator = t, this.state = u, this.$get = v, v.$inject = ["$rootScope", "$q", "$view", "$injector", "$resolve", "$stateParams", "$urlRouter", "$location", "$urlMatcherFactory"] } function w() { function a(a, b) { return { load: function (a, c) { var d, e = { template: null, controller: null, view: null, locals: null, notify: !0, async: !0, params: {} }; return c = R(e, c), c.view && (d = b.fromConfig(c.view, c.params, c.locals)), d } } } this.$get = a, a.$inject = ["$rootScope", "$templateFactory"] } function x() { var a = !1; this.useAnchorScroll = function () { a = !0 }, this.$get = ["$anchorScroll", "$timeout", function (b, c) { return a ? b : function (a) { return c(function () { a[0].scrollIntoView() }, 0, !1) } }] } function y(a, c, d, e) { function f() { return c.has ? function (a) { return c.has(a) ? c.get(a) : null } : function (a) { try { return c.get(a) } catch (b) { return null } } } function g(a, c) { function d(a) { return 1 === V && W >= 4 ? !!j.enabled(a) : 1 === V && W >= 2 ? !!j.enabled() : !!i } var e = { enter: function (a, b, c) { b.after(a), c() }, leave: function (a, b) { a.remove(), b() } }; if (a.noanimation) return e; if (j) return { enter: function (a, c, f) { d(a) ? b.version.minor > 2 ? j.enter(a, null, c).then(f) : j.enter(a, null, c, f) : e.enter(a, c, f) }, leave: function (a, c) { d(a) ? b.version.minor > 2 ? j.leave(a).then(c) : j.leave(a, c) : e.leave(a, c) } }; if (i) { var f = i && i(c, a); return { enter: function (a, b, c) { f.enter(a, null, b), c() }, leave: function (a, b) { f.leave(a), b() } } } return e } var h = f(), i = h("$animator"), j = h("$animate"), k = { restrict: "ECA", terminal: !0, priority: 400, transclude: "element", compile: function (c, f, h) { return function (c, f, i) { function j() { function a() { b && b.remove(), c && c.$destroy() } var b = l, c = n; c && (c._willBeDestroyed = !0), m ? (r.leave(m, function () { a(), l = null }), l = m) : (a(), l = null), m = null, n = null } function k(g) { var k, l = A(c, i, f, e), s = l && a.$current && a.$current.locals[l]; if ((g || s !== o) && !c._willBeDestroyed) { k = c.$new(), o = a.$current.locals[l], k.$emit("$viewContentLoading", l); var t = h(k, function (a) { r.enter(a, f, function () { n && n.$emit("$viewContentAnimationEnded"), (b.isDefined(q) && !q || c.$eval(q)) && d(a) }), j() }); m = t, n = k, n.$emit("$viewContentLoaded", l), n.$eval(p) } } var l, m, n, o, p = i.onload || "", q = i.autoscroll, r = g(i, c); c.$on("$stateChangeSuccess", function () { k(!1) }), k(!0) } } }; return k } function z(a, b, c, d) { return { restrict: "ECA", priority: -400, compile: function (e) { var f = e.html(); return function (e, g, h) { var i = c.$current, j = A(e, h, g, d), k = i && i.locals[j]; if (k) { g.data("$uiView", { name: j, state: k.$$state }), g.html(k.$template ? k.$template : f); var l = a(g.contents()); if (k.$$controller) { k.$scope = e, k.$element = g; var m = b(k.$$controller, k); k.$$controllerAs && (e[k.$$controllerAs] = m), g.data("$ngControllerController", m), g.children().data("$ngControllerController", m) } l(e) } } } } } function A(a, b, c, d) { var e = d(b.uiView || b.name || "")(a), f = c.inheritedData("$uiView"); return e.indexOf("@") >= 0 ? e : e + "@" + (f ? f.state.name : "") } function B(a, b) { var c, d = a.match(/^\s*({[^}]*})\s*$/); if (d && (a = b + "(" + d[1] + ")"), c = a.replace(/\n/g, " ").match(/^([^(]+?)\s*(\((.*)\))?$/), !c || 4 !== c.length) throw new Error("Invalid state ref '" + a + "'"); return { state: c[1], paramExpr: c[3] || null } } function C(a) { var b = a.parent().inheritedData("$uiView"); return b && b.state && b.state.name ? b.state : void 0 } function D(a) { var b = "[object SVGAnimatedString]" === Object.prototype.toString.call(a.prop("href")), c = "FORM" === a[0].nodeName; return { attr: c ? "action" : b ? "xlink:href" : "href", isAnchor: "A" === a.prop("tagName").toUpperCase(), clickable: !c } } function E(a, b, c, d, e) { return function (f) { var g = f.which || f.button, h = e(); if (!(g > 1 || f.ctrlKey || f.metaKey || f.shiftKey || a.attr("target"))) { var i = c(function () { b.go(h.state, h.params, h.options) }); f.preventDefault(); var j = d.isAnchor && !h.href ? 1 : 0; f.preventDefault = function () { j-- <= 0 && c.cancel(i) } } } } function F(a, b) { return { relative: C(a) || b.$current, inherit: !0 } } function G(a, c) { return { restrict: "A", require: ["?^uiSrefActive", "?^uiSrefActiveEq"], link: function (d, e, f, g) { var h = B(f.uiSref, a.current.name), i = { state: h.state, href: null, params: null }, j = D(e), k = g[1] || g[0]; i.options = R(F(e, a), f.uiSrefOpts ? d.$eval(f.uiSrefOpts) : {}); var l = function (c) { c && (i.params = b.copy(c)), i.href = a.href(h.state, i.params, i.options), k && k.$$addStateInfo(h.state, i.params), null !== i.href && f.$set(j.attr, i.href) }; h.paramExpr && (d.$watch(h.paramExpr, function (a) { a !== i.params && l(a) }, !0), i.params = b.copy(d.$eval(h.paramExpr))), l(), j.clickable && e.bind("click", E(e, a, c, j, function () { return i })) } } } function H(a, b) { return { restrict: "A", require: ["?^uiSrefActive", "?^uiSrefActiveEq"], link: function (c, d, e, f) { function g(b) { l.state = b[0], l.params = b[1], l.options = b[2], l.href = a.href(l.state, l.params, l.options), i && i.$$addStateInfo(l.state, l.params), l.href && e.$set(h.attr, l.href) } var h = D(d), i = f[1] || f[0], j = [e.uiState, e.uiStateParams || null, e.uiStateOpts || null], k = "[" + j.map(function (a) { return a || "null" }).join(", ") + "]", l = { state: null, params: null, options: null, href: null }; c.$watch(k, g, !0), g(c.$eval(k)), h.clickable && d.bind("click", E(d, a, b, h, function () { return l })) } } } function I(a, b, c) { return { restrict: "A", controller: ["$scope", "$element", "$attrs", "$timeout", function (b, d, e, f) { function g(b, c, e) { var f = a.get(b, C(d)), g = h(b, c); p.push({ state: f || { name: b }, params: c, hash: g }), q[g] = e } function h(a, c) { if (!N(a)) throw new Error("state should be a string"); return O(c) ? a + T(c) : (c = b.$eval(c), O(c) ? a + T(c) : a) } function i() { for (var a = 0; a < p.length; a++) l(p[a].state, p[a].params) ? j(d, q[p[a].hash]) : k(d, q[p[a].hash]), m(p[a].state, p[a].params) ? j(d, n) : k(d, n) } function j(a, b) { f(function () { a.addClass(b) }) } function k(a, b) { a.removeClass(b) } function l(b, c) { return a.includes(b.name, c) } function m(b, c) { return a.is(b.name, c) } var n, o, p = [], q = {}; n = c(e.uiSrefActiveEq || "", !1)(b); try { o = b.$eval(e.uiSrefActive) } catch (r) { } o = o || c(e.uiSrefActive || "", !1)(b), O(o) && Q(o, function (c, d) { if (N(c)) { var e = B(c, a.current.name); g(e.state, b.$eval(e.paramExpr), d) } }), this.$$addStateInfo = function (a, b) { O(o) && p.length > 0 || (g(a, b, o), i()) }, b.$on("$stateChangeSuccess", i), i() }] } } function J(a) { var b = function (b, c) { return a.is(b, c) }; return b.$stateful = !0, b } function K(a) { var b = function (b, c, d) { return a.includes(b, c, d) }; return b.$stateful = !0, b } var L = b.isDefined, M = b.isFunction, N = b.isString, O = b.isObject, P = b.isArray, Q = b.forEach, R = b.extend, S = b.copy, T = b.toJson; b.module("ui.router.util", ["ng"]), b.module("ui.router.router", ["ui.router.util"]), b.module("ui.router.state", ["ui.router.router", "ui.router.util"]), b.module("ui.router", ["ui.router.state"]), b.module("ui.router.compat", ["ui.router"]), p.$inject = ["$q", "$injector"], b.module("ui.router.util").service("$resolve", p), q.$inject = ["$http", "$templateCache", "$injector"], b.module("ui.router.util").service("$templateFactory", q); var U; r.prototype.concat = function (a, b) { var c = { caseInsensitive: U.caseInsensitive(), strict: U.strictMode(), squash: U.defaultSquashPolicy() }; return new r(this.sourcePath + a + this.sourceSearch, R(c, b), this) }, r.prototype.toString = function () { return this.source }, r.prototype.exec = function (a, b) { function c(a) { function b(a) { return a.split("").reverse().join("") } function c(a) { return a.replace(/\\-/g, "-") } var d = b(a).split(/-(?!\\)/), e = o(d, b); return o(e, c).reverse() } var d = this.regexp.exec(a); if (!d) return null; b = b || {}; var e, f, g, h = this.parameters(), i = h.length, j = this.segments.length - 1, k = {}; if (j !== d.length - 1) throw new Error("Unbalanced capture group in route '" + this.source + "'"); var l, m; for (e = 0; j > e; e++) { for (g = h[e], l = this.params[g], m = d[e + 1], f = 0; f < l.replace.length; f++) l.replace[f].from === m && (m = l.replace[f].to); m && l.array === !0 && (m = c(m)), L(m) && (m = l.type.decode(m)), k[g] = l.value(m) } for (; i > e; e++) { for (g = h[e], k[g] = this.params[g].value(b[g]), l = this.params[g], m = b[g], f = 0; f < l.replace.length; f++) l.replace[f].from === m && (m = l.replace[f].to); L(m) && (m = l.type.decode(m)), k[g] = l.value(m) } return k }, r.prototype.parameters = function (a) { return L(a) ? this.params[a] || null : this.$$paramNames }, r.prototype.validates = function (a) { return this.params.$$validates(a) }, r.prototype.format = function (a) { function b(a) { return encodeURIComponent(a).replace(/-/g, function (a) { return "%5C%" + a.charCodeAt(0).toString(16).toUpperCase() }) } a = a || {}; var c = this.segments, d = this.parameters(), e = this.params; if (!this.validates(a)) return null; var f, g = !1, h = c.length - 1, i = d.length, j = c[0]; for (f = 0; i > f; f++) { var k = h > f, l = d[f], m = e[l], n = m.value(a[l]), p = m.isOptional && m.type.equals(m.value(), n), q = p ? m.squash : !1, r = m.type.encode(n); if (k) { var s = c[f + 1], t = f + 1 === h; if (q === !1) null != r && (j += P(r) ? o(r, b).join("-") : encodeURIComponent(r)), j += s; else if (q === !0) { var u = j.match(/\/$/) ? /\/?(.*)/ : /(.*)/; j += s.match(u)[1] } else N(q) && (j += q + s); t && m.squash === !0 && "/" === j.slice(-1) && (j = j.slice(0, -1)) } else { if (null == r || p && q !== !1) continue; if (P(r) || (r = [r]), 0 === r.length) continue; r = o(r, encodeURIComponent).join("&" + l + "="), j += (g ? "&" : "?") + (l + "=" + r), g = !0 } } return j }, s.prototype.is = function (a, b) { return !0 }, s.prototype.encode = function (a, b) { return a }, s.prototype.decode = function (a, b) { return a }, s.prototype.equals = function (a, b) { return a == b }, s.prototype.$subPattern = function () { var a = this.pattern.toString(); return a.substr(1, a.length - 2) }, s.prototype.pattern = /.*/, s.prototype.toString = function () { return "{Type:" + this.name + "}" }, s.prototype.$normalize = function (a) { return this.is(a) ? a : this.decode(a) }, s.prototype.$asArray = function (a, b) { function d(a, b) { function d(a, b) { return function () { return a[b].apply(a, arguments) } } function e(a) { return P(a) ? a : L(a) ? [a] : [] } function f(a) { switch (a.length) { case 0: return c; case 1: return "auto" === b ? a[0] : a; default: return a } } function g(a) { return !a } function h(a, b) { return function (c) { if (P(c) && 0 === c.length) return c; c = e(c); var d = o(c, a); return b === !0 ? 0 === n(d, g).length : f(d) } } function i(a) { return function (b, c) { var d = e(b), f = e(c); if (d.length !== f.length) return !1; for (var g = 0; g < d.length; g++) if (!a(d[g], f[g])) return !1; return !0 } } this.encode = h(d(a, "encode")), this.decode = h(d(a, "decode")), this.is = h(d(a, "is"), !0), this.equals = i(d(a, "equals")), this.pattern = a.pattern, this.$normalize = h(d(a, "$normalize")), this.name = a.name, this.$arrayMode = b } if (!a) return this; if ("auto" === a && !b) throw new Error("'auto' array mode is for query parameters only"); return new d(this, a) }, b.module("ui.router.util").provider("$urlMatcherFactory", t), b.module("ui.router.util").run(["$urlMatcherFactory", function (a) { }]), u.$inject = ["$locationProvider", "$urlMatcherFactoryProvider"], b.module("ui.router.router").provider("$urlRouter", u), v.$inject = ["$urlRouterProvider", "$urlMatcherFactoryProvider"], b.module("ui.router.state").factory("$stateParams", function () { return {} }).provider("$state", v), w.$inject = [], b.module("ui.router.state").provider("$view", w), b.module("ui.router.state").provider("$uiViewScroll", x); var V = b.version.major, W = b.version.minor; y.$inject = ["$state", "$injector", "$uiViewScroll", "$interpolate"], z.$inject = ["$compile", "$controller", "$state", "$interpolate"], b.module("ui.router.state").directive("uiView", y), b.module("ui.router.state").directive("uiView", z), G.$inject = ["$state", "$timeout"], H.$inject = ["$state", "$timeout"], I.$inject = ["$state", "$stateParams", "$interpolate"], b.module("ui.router.state").directive("uiSref", G).directive("uiSrefActive", I).directive("uiSrefActiveEq", I).directive("uiState", H),
    J.$inject = ["$state"], K.$inject = ["$state"], b.module("ui.router.state").filter("isState", J).filter("includedByState", K)
}(window, window.angular);
/* ng-infinite-scroll - v1.3.0 - 2016-06-30 */
angular.module('infinite-scroll',[]).value('THROTTLE_MILLISECONDS',null).directive('infiniteScroll',['$rootScope','$window','$interval','THROTTLE_MILLISECONDS',function($rootScope,$window,$interval,THROTTLE_MILLISECONDS){return{scope:{infiniteScroll:'&',infiniteScrollContainer:'=',infiniteScrollDistance:'=',infiniteScrollDisabled:'=',infiniteScrollUseDocumentBottom:'=',infiniteScrollListenForEvent:'@'},link:function(scope,elem,attrs){var changeContainer,checkInterval,checkWhenEnabled,container,handleInfiniteScrollContainer,handleInfiniteScrollDisabled,handleInfiniteScrollDistance,handleInfiniteScrollUseDocumentBottom,handler,height,immediateCheck,offsetTop,pageYOffset,scrollDistance,scrollEnabled,throttle,unregisterEventListener,useDocumentBottom,windowElement;windowElement=angular.element($window);scrollDistance=null;scrollEnabled=null;checkWhenEnabled=null;container=null;immediateCheck=true;useDocumentBottom=false;unregisterEventListener=null;checkInterval=false;height=function(elem){elem=elem[0]||elem;if(isNaN(elem.offsetHeight)){return elem.document.documentElement.clientHeight}else{return elem.offsetHeight}};offsetTop=function(elem){if(!elem[0].getBoundingClientRect||elem.css('none')){return}return elem[0].getBoundingClientRect().top+pageYOffset(elem)};pageYOffset=function(elem){elem=elem[0]||elem;if(isNaN(window.pageYOffset)){return elem.document.documentElement.scrollTop}else{return elem.ownerDocument.defaultView.pageYOffset}};handler=function(){var containerBottom,containerTopOffset,elementBottom,remaining,shouldScroll;if(container===windowElement){containerBottom=height(container)+pageYOffset(container[0].document.documentElement);elementBottom=offsetTop(elem)+height(elem)}else{containerBottom=height(container);containerTopOffset=0;if(offsetTop(container)!==void 0){containerTopOffset=offsetTop(container)}elementBottom=offsetTop(elem)-containerTopOffset+height(elem)}if(useDocumentBottom){elementBottom=height((elem[0].ownerDocument||elem[0].document).documentElement)}remaining=elementBottom-containerBottom;shouldScroll=remaining<=height(container)*scrollDistance+1;if(shouldScroll){checkWhenEnabled=true;if(scrollEnabled){if(scope.$$phase||$rootScope.$$phase){return scope.infiniteScroll()}else{return scope.$apply(scope.infiniteScroll)}}}else{if(checkInterval){$interval.cancel(checkInterval)}return checkWhenEnabled=false}};throttle=function(func,wait){var later,previous,timeout;timeout=null;previous=0;later=function(){previous=new Date().getTime();$interval.cancel(timeout);timeout=null;return func.call()};return function(){var now,remaining;now=new Date().getTime();remaining=wait-(now-previous);if(remaining<=0){$interval.cancel(timeout);timeout=null;previous=now;return func.call()}else{if(!timeout){return timeout=$interval(later,remaining,1)}}}};if(THROTTLE_MILLISECONDS!=null){handler=throttle(handler,THROTTLE_MILLISECONDS)}scope.$on('$destroy',function(){container.unbind('scroll',handler);if(unregisterEventListener!=null){unregisterEventListener();unregisterEventListener=null}if(checkInterval){return $interval.cancel(checkInterval)}});handleInfiniteScrollDistance=function(v){return scrollDistance=parseFloat(v)||0};scope.$watch('infiniteScrollDistance',handleInfiniteScrollDistance);handleInfiniteScrollDistance(scope.infiniteScrollDistance);handleInfiniteScrollDisabled=function(v){scrollEnabled=!v;if(scrollEnabled&&checkWhenEnabled){checkWhenEnabled=false;return handler()}};scope.$watch('infiniteScrollDisabled',handleInfiniteScrollDisabled);handleInfiniteScrollDisabled(scope.infiniteScrollDisabled);handleInfiniteScrollUseDocumentBottom=function(v){return useDocumentBottom=v};scope.$watch('infiniteScrollUseDocumentBottom',handleInfiniteScrollUseDocumentBottom);handleInfiniteScrollUseDocumentBottom(scope.infiniteScrollUseDocumentBottom);changeContainer=function(newContainer){if(container!=null){container.unbind('scroll',handler)}container=newContainer;if(newContainer!=null){return container.bind('scroll',handler)}};changeContainer(windowElement);if(scope.infiniteScrollListenForEvent){unregisterEventListener=$rootScope.$on(scope.infiniteScrollListenForEvent,handler)}handleInfiniteScrollContainer=function(newContainer){if((newContainer==null)||newContainer.length===0){return}if(newContainer.nodeType&&newContainer.nodeType===1){newContainer=angular.element(newContainer)}else if(typeof newContainer.append==='function'){newContainer=angular.element(newContainer[newContainer.length-1])}else if(typeof newContainer==='string'){newContainer=angular.element(document.querySelector(newContainer))}if(newContainer!=null){return changeContainer(newContainer)}else{throw new Error("invalid infinite-scroll-container attribute.")}};scope.$watch('infiniteScrollContainer',handleInfiniteScrollContainer);handleInfiniteScrollContainer(scope.infiniteScrollContainer||[]);if(attrs.infiniteScrollParent!=null){changeContainer(angular.element(elem.parent()))}if(attrs.infiniteScrollImmediateCheck!=null){immediateCheck=scope.$eval(attrs.infiniteScrollImmediateCheck)}return checkInterval=$interval((function(){if(immediateCheck){handler()}return $interval.cancel(checkInterval)}))}}}]);if(typeof module!=="undefined"&&typeof exports!=="undefined"&&module.exports===exports){module.exports='infinite-scroll'}
/**
 * Cookie plugin
 *
 * Copyright (c) 2006 Klaus Hartl (stilbuero.de)
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 */
/**
 * Create a cookie with the given name and value and other optional parameters.
 *
 * @example $.cookie('the_cookie', 'the_value');
 * @desc Set the value of a cookie.
 * @example $.cookie('the_cookie', 'the_value', {expires: 7, path: '/', domain: 'jquery.com', secure: true});
 * @desc Create a cookie with all available options.
 * @example $.cookie('the_cookie', 'the_value');
 * @desc Create a session cookie.
 * @example $.cookie('the_cookie', null);
 * @desc Delete a cookie by passing null as value.
 *
 * @param String name The name of the cookie.
 * @param String value The value of the cookie.
 * @param Object options An object literal containing key/value pairs to provide optional cookie attributes.
 * @option Number|Date expires Either an integer specifying the expiration date from now on in days or a Date object.
 *                             If a negative value is specified (e.g. a date in the past), the cookie will be deleted.
 *                             If set to null or omitted, the cookie will be a session cookie and will not be retained
 *                             when the the browser exits.
 * @option String path The value of the path atribute of the cookie (default: path of page that created the cookie).
 * @option String domain The value of the domain attribute of the cookie (default: domain of page that created the cookie).
 * @option Boolean secure If true, the secure attribute of the cookie will be set and the cookie transmission will
 *                        require a secure protocol (like HTTPS).
 * @type undefined
 *
 * @name $.cookie
 * @cat Plugins/Cookie
 * @author Klaus Hartl/klaus.hartl@stilbuero.de
 */
/**
 * Get the value of a cookie with the given name.
 *
 * @example $.cookie('the_cookie');
 * @desc Get the value of a cookie.
 *
 * @param String name The name of the cookie.
 * @return The value of the cookie.
 * @type String
 *
 * @name $.cookie
 * @cat Plugins/Cookie
 * @author Klaus Hartl/klaus.hartl@stilbuero.de
 */
jQuery.cookie = function (name, value, options) { if (typeof value != 'undefined') { options = options || {}; if (value === null) { value = ''; options.expires = -1 } var expires = ''; if (options.expires && (typeof options.expires == 'number' || options.expires.toUTCString)) { var date; if (typeof options.expires == 'number') { date = new Date(); date.setTime(date.getTime() + (options.expires * 24 * 60 * 60 * 1000)) } else { date = options.expires } expires = '; expires=' + date.toUTCString(); } var path = options.path ? '; path=' + options.path : ''; var domain = options.domain ? '; domain=' + options.domain : ''; var secure = options.secure ? '; secure' : ''; document.cookie = [name, '=', encodeURIComponent(value), expires, path, domain, secure].join('') } else { var cookieValue = null; if (document.cookie && document.cookie != '') { var cookies = document.cookie.split(';'); for (var i = 0; i < cookies.length; i += 1) { var cookie = jQuery.trim(cookies[i]); if (cookie.substring(0, name.length + 1) == (name + '=')) { cookieValue = decodeURIComponent(cookie.substring(name.length + 1)); break } } } return cookieValue } };
/*! layer-v3.0.3 Web弹层组件 MIT License  http://layer.layui.com/  By 贤心 */;
! function (e, t) { "use strict"; var i, n, a = e.layui && layui.define, o = { getPath: function () { var e = document.scripts, t = e[e.length - 1], i = t.src; if (!t.getAttribute("merge")) return i.substring(0, i.lastIndexOf("/") + 1) }(), config: {}, end: {}, minIndex: 0, minLeft: [], btn: ["&#x786E;&#x5B9A;", "&#x53D6;&#x6D88;"], type: ["dialog", "page", "iframe", "loading", "tips"] }, r = { v: "3.0.3", ie: function () { var t = navigator.userAgent.toLowerCase(); return !!(e.ActiveXObject || "ActiveXObject" in e) && ((t.match(/msie\s(\d+)/) || [])[1] || "11") }(), index: e.layer && e.layer.v ? 1e5 : 0, path: o.getPath, config: function (e, t) { return e = e || {}, r.cache = o.config = i.extend({}, o.config, e), r.path = o.config.path || r.path, "string" == typeof e.extend && (e.extend = [e.extend]), o.config.path && r.ready(), e.extend ? (a ? layui.addcss("modules/layer/" + e.extend) : r.link("skin/" + e.extend), this) : this }, link: function (t, n, a) { if (r.path) { var o = i("head")[0], s = document.createElement("link"); "string" == typeof n && (a = n); var l = (a || t).replace(/\.|\//g, ""), f = "layuicss-" + l, c = 0; s.rel = "stylesheet", s.href = r.path + t, s.id = f, i("#" + f)[0] || o.appendChild(s), "function" == typeof n && ! function u() { return ++c > 80 ? e.console && console.error("layer.css: Invalid") : void (1989 === parseInt(i("#" + f).css("width")) ? n() : setTimeout(u, 100)) }() } }, ready: function (e) { var t = "skinlayercss", i = "303"; return a ? layui.addcss("../css/layer.css?v=" + r.v + i, e, t) : r.link("../css/layer.css?v=" + r.v + i, e, t), this }, alert: function (e, t, n) { var a = "function" == typeof t; return a && (n = t), r.open(i.extend({ content: e, yes: n }, a ? {} : t)) }, confirm: function (e, t, n, a) { var s = "function" == typeof t; return s && (a = n, n = t), r.open(i.extend({ content: e, btn: o.btn, yes: n, btn2: a }, s ? {} : t)) }, msg: function (e, n, a) { var s = "function" == typeof n, f = o.config.skin, c = (f ? f + " " + f + "-msg" : "") || "layui-layer-msg", u = l.anim.length - 1; return s && (a = n), r.open(i.extend({ content: e, time: 3e3, shade: !1, skin: c, title: !1, closeBtn: !1, btn: !1, resize: !1, end: a }, s && !o.config.skin ? { skin: c + " layui-layer-hui", anim: u } : function () { return n = n || {}, (n.icon === -1 || n.icon === t && !o.config.skin) && (n.skin = c + " " + (n.skin || "layui-layer-hui")), n }())) }, load: function (e, t) { return r.open(i.extend({ type: 3, icon: e || 0, resize: !1, shade: .01 }, t)) }, tips: function (e, t, n) { return r.open(i.extend({ type: 4, content: [e, t], closeBtn: !1, time: 3e3, shade: !1, resize: !1, fixed: !1, maxWidth: 210 }, n)) } }, s = function (e) { var t = this; t.index = ++r.index, t.config = i.extend({}, t.config, o.config, e), document.body ? t.creat() : setTimeout(function () { t.creat() }, 30) }; s.pt = s.prototype; var l = ["layui-layer", ".layui-layer-title", ".layui-layer-main", ".layui-layer-dialog", "layui-layer-iframe", "layui-layer-content", "layui-layer-btn", "layui-layer-close"]; l.anim = ["layer-anim", "layer-anim-01", "layer-anim-02", "layer-anim-03", "layer-anim-04", "layer-anim-05", "layer-anim-06"], s.pt.config = { type: 0, shade: .3, fixed: !0, move: l[1], title: "&#x4FE1;&#x606F;", offset: "auto", area: "auto", closeBtn: 1, time: 0, zIndex: 19891014, maxWidth: 360, anim: 0, isOutAnim: !0, icon: -1, moveType: 1, resize: !0, scrollbar: !0, tips: 2 }, s.pt.vessel = function (e, t) { var n = this, a = n.index, r = n.config, s = r.zIndex + a, f = "object" == typeof r.title, c = r.maxmin && (1 === r.type || 2 === r.type), u = r.title ? '<div class="layui-layer-title" style="' + (f ? r.title[1] : "") + '">' + (f ? r.title[0] : r.title) + "</div>" : ""; return r.zIndex = s, t([r.shade ? '<div class="layui-layer-shade" id="layui-layer-shade' + a + '" times="' + a + '" style="' + ("z-index:" + (s - 1) + "; background-color:" + (r.shade[1] || "#000") + "; opacity:" + (r.shade[0] || r.shade) + "; filter:alpha(opacity=" + (100 * r.shade[0] || 100 * r.shade) + ");") + '"></div>' : "", '<div class="' + l[0] + (" layui-layer-" + o.type[r.type]) + (0 != r.type && 2 != r.type || r.shade ? "" : " layui-layer-border") + " " + (r.skin || "") + '" id="' + l[0] + a + '" type="' + o.type[r.type] + '" times="' + a + '" showtime="' + r.time + '" conType="' + (e ? "object" : "string") + '" style="z-index: ' + s + "; width:" + r.area[0] + ";height:" + r.area[1] + (r.fixed ? "" : ";position:absolute;") + '">' + (e && 2 != r.type ? "" : u) + '<div id="' + (r.id || "") + '" class="layui-layer-content' + (0 == r.type && r.icon !== -1 ? " layui-layer-padding" : "") + (3 == r.type ? " layui-layer-loading" + r.icon : "") + '">' + (0 == r.type && r.icon !== -1 ? '<i class="layui-layer-ico layui-layer-ico' + r.icon + '"></i>' : "") + (1 == r.type && e ? "" : r.content || "") + '</div><span class="layui-layer-setwin">' + function () { var e = c ? '<a class="layui-layer-min" href="javascript:;"><cite></cite></a><a class="layui-layer-ico layui-layer-max" href="javascript:;"></a>' : ""; return r.closeBtn && (e += '<a class="layui-layer-ico ' + l[7] + " " + l[7] + (r.title ? r.closeBtn : 4 == r.type ? "1" : "2") + '" href="javascript:;"></a>'), e }() + "</span>" + (r.btn ? function () { var e = ""; "string" == typeof r.btn && (r.btn = [r.btn]); for (var t = 0, i = r.btn.length; t < i; t++) e += '<a class="' + l[6] + t + '">' + r.btn[t] + "</a>"; return '<div class="' + l[6] + " layui-layer-btn-" + (r.btnAlign || "") + '">' + e + "</div>" }() : "") + (r.resize ? '<span class="layui-layer-resize"></span>' : "") + "</div>"], u, i('<div class="layui-layer-move"></div>')), n }, s.pt.creat = function () { var e = this, t = e.config, a = e.index, s = t.content, f = "object" == typeof s, c = i("body"); if (!t.id || !i("#" + t.id)[0]) { switch ("string" == typeof t.area && (t.area = "auto" === t.area ? ["", ""] : [t.area, ""]), t.shift && (t.anim = t.shift), 6 == r.ie && (t.fixed = !1), t.type) { case 0: t.btn = "btn" in t ? t.btn : o.btn[0], r.closeAll("dialog"); break; case 2: var s = t.content = f ? t.content : [t.content, "auto"]; t.content = '<iframe scrolling="' + (t.content[1] || "auto") + '" allowtransparency="true" id="' + l[4] + a + '" name="' + l[4] + a + '" onload="this.className=\'\';" class="layui-layer-load" frameborder="0" src="' + t.content[0] + '"></iframe>'; break; case 3: delete t.title, delete t.closeBtn, t.icon === -1 && 0 === t.icon, r.closeAll("loading"); break; case 4: f || (t.content = [t.content, "body"]), t.follow = t.content[1], t.content = t.content[0] + '<i class="layui-layer-TipsG"></i>', delete t.title, t.tips = "object" == typeof t.tips ? t.tips : [t.tips, !0], t.tipsMore || r.closeAll("tips") } e.vessel(f, function (n, r, u) { c.append(n[0]), f ? function () { 2 == t.type || 4 == t.type ? function () { i("body").append(n[1]) }() : function () { s.parents("." + l[0])[0] || (s.data("display", s.css("display")).show().addClass("layui-layer-wrap").wrap(n[1]), i("#" + l[0] + a).find("." + l[5]).before(r)) }() }() : c.append(n[1]), i(".layui-layer-move")[0] || c.append(o.moveElem = u), e.layero = i("#" + l[0] + a), t.scrollbar || l.html.css("overflow", "hidden").attr("layer-full", a) }).auto(a), 2 == t.type && 6 == r.ie && e.layero.find("iframe").attr("src", s[0]), 4 == t.type ? e.tips() : e.offset(), t.fixed && n.on("resize", function () { e.offset(), (/^\d+%$/.test(t.area[0]) || /^\d+%$/.test(t.area[1])) && e.auto(a), 4 == t.type && e.tips() }), t.time <= 0 || setTimeout(function () { r.close(e.index) }, t.time), e.move().callback(), l.anim[t.anim] && e.layero.addClass(l.anim[t.anim]), t.isOutAnim && e.layero.data("isOutAnim", !0) } }, s.pt.auto = function (e) { function t(e) { e = s.find(e), e.height(f[1] - c - u - 2 * (0 | parseFloat(e.css("padding-top")))) } var a = this, o = a.config, s = i("#" + l[0] + e); "" === o.area[0] && o.maxWidth > 0 && (r.ie && r.ie < 8 && o.btn && s.width(s.innerWidth()), s.outerWidth() > o.maxWidth && s.width(o.maxWidth)); var f = [s.innerWidth(), s.innerHeight()], c = s.find(l[1]).outerHeight() || 0, u = s.find("." + l[6]).outerHeight() || 0; switch (o.type) { case 2: t("iframe"); break; default: "" === o.area[1] ? o.fixed && f[1] >= n.height() && (f[1] = n.height(), t("." + l[5])) : t("." + l[5]) } return a }, s.pt.offset = function () { var e = this, t = e.config, i = e.layero, a = [i.outerWidth(), i.outerHeight()], o = "object" == typeof t.offset; e.offsetTop = (n.height() - a[1]) / 2, e.offsetLeft = (n.width() - a[0]) / 2, o ? (e.offsetTop = t.offset[0], e.offsetLeft = t.offset[1] || e.offsetLeft) : "auto" !== t.offset && ("t" === t.offset ? e.offsetTop = 0 : "r" === t.offset ? e.offsetLeft = n.width() - a[0] : "b" === t.offset ? e.offsetTop = n.height() - a[1] : "l" === t.offset ? e.offsetLeft = 0 : "lt" === t.offset ? (e.offsetTop = 0, e.offsetLeft = 0) : "lb" === t.offset ? (e.offsetTop = n.height() - a[1], e.offsetLeft = 0) : "rt" === t.offset ? (e.offsetTop = 0, e.offsetLeft = n.width() - a[0]) : "rb" === t.offset ? (e.offsetTop = n.height() - a[1], e.offsetLeft = n.width() - a[0]) : e.offsetTop = t.offset), t.fixed || (e.offsetTop = /%$/.test(e.offsetTop) ? n.height() * parseFloat(e.offsetTop) / 100 : parseFloat(e.offsetTop), e.offsetLeft = /%$/.test(e.offsetLeft) ? n.width() * parseFloat(e.offsetLeft) / 100 : parseFloat(e.offsetLeft), e.offsetTop += n.scrollTop(), e.offsetLeft += n.scrollLeft()), i.attr("minLeft") && (e.offsetTop = n.height() - (i.find(l[1]).outerHeight() || 0), e.offsetLeft = i.css("left")), i.css({ top: e.offsetTop, left: e.offsetLeft }) }, s.pt.tips = function () { var e = this, t = e.config, a = e.layero, o = [a.outerWidth(), a.outerHeight()], r = i(t.follow); r[0] || (r = i("body")); var s = { width: r.outerWidth(), height: r.outerHeight(), top: r.offset().top, left: r.offset().left }, f = a.find(".layui-layer-TipsG"), c = t.tips[0]; t.tips[1] || f.remove(), s.autoLeft = function () { s.left + o[0] - n.width() > 0 ? (s.tipLeft = s.left + s.width - o[0], f.css({ right: 12, left: "auto" })) : s.tipLeft = s.left }, s.where = [function () { s.autoLeft(), s.tipTop = s.top - o[1] - 10, f.removeClass("layui-layer-TipsB").addClass("layui-layer-TipsT").css("border-right-color", t.tips[1]) }, function () { s.tipLeft = s.left + s.width + 10, s.tipTop = s.top, f.removeClass("layui-layer-TipsL").addClass("layui-layer-TipsR").css("border-bottom-color", t.tips[1]) }, function () { s.autoLeft(), s.tipTop = s.top + s.height + 10, f.removeClass("layui-layer-TipsT").addClass("layui-layer-TipsB").css("border-right-color", t.tips[1]) }, function () { s.tipLeft = s.left - o[0] - 10, s.tipTop = s.top, f.removeClass("layui-layer-TipsR").addClass("layui-layer-TipsL").css("border-bottom-color", t.tips[1]) }], s.where[c - 1](), 1 === c ? s.top - (n.scrollTop() + o[1] + 16) < 0 && s.where[2]() : 2 === c ? n.width() - (s.left + s.width + o[0] + 16) > 0 || s.where[3]() : 3 === c ? s.top - n.scrollTop() + s.height + o[1] + 16 - n.height() > 0 && s.where[0]() : 4 === c && o[0] + 16 - s.left > 0 && s.where[1](), a.find("." + l[5]).css({ "background-color": t.tips[1], "padding-right": t.closeBtn ? "30px" : "" }), a.css({ left: s.tipLeft - (t.fixed ? n.scrollLeft() : 0), top: s.tipTop - (t.fixed ? n.scrollTop() : 0) }) }, s.pt.move = function () { var e = this, t = e.config, a = i(document), s = e.layero, l = s.find(t.move), f = s.find(".layui-layer-resize"), c = {}; return t.move && l.css("cursor", "move"), l.on("mousedown", function (e) { e.preventDefault(), t.move && (c.moveStart = !0, c.offset = [e.clientX - parseFloat(s.css("left")), e.clientY - parseFloat(s.css("top"))], o.moveElem.css("cursor", "move").show()) }), f.on("mousedown", function (e) { e.preventDefault(), c.resizeStart = !0, c.offset = [e.clientX, e.clientY], c.area = [s.outerWidth(), s.outerHeight()], o.moveElem.css("cursor", "se-resize").show() }), a.on("mousemove", function (i) { if (c.moveStart) { var a = i.clientX - c.offset[0], o = i.clientY - c.offset[1], l = "fixed" === s.css("position"); if (i.preventDefault(), c.stX = l ? 0 : n.scrollLeft(), c.stY = l ? 0 : n.scrollTop(), !t.moveOut) { var f = n.width() - s.outerWidth() + c.stX, u = n.height() - s.outerHeight() + c.stY; a < c.stX && (a = c.stX), a > f && (a = f), o < c.stY && (o = c.stY), o > u && (o = u) } s.css({ left: a, top: o }) } if (t.resize && c.resizeStart) { var a = i.clientX - c.offset[0], o = i.clientY - c.offset[1]; i.preventDefault(), r.style(e.index, { width: c.area[0] + a, height: c.area[1] + o }), c.isResize = !0, t.resizing && t.resizing(s) } }).on("mouseup", function (e) { c.moveStart && (delete c.moveStart, o.moveElem.hide(), t.moveEnd && t.moveEnd(s)), c.resizeStart && (delete c.resizeStart, o.moveElem.hide()) }), e }, s.pt.callback = function () { function e() { var e = a.cancel && a.cancel(t.index, n); e === !1 || r.close(t.index) } var t = this, n = t.layero, a = t.config; t.openLayer(), a.success && (2 == a.type ? n.find("iframe").on("load", function () { a.success(n, t.index) }) : a.success(n, t.index)), 6 == r.ie && t.IE6(n), n.find("." + l[6]).children("a").on("click", function () { var e = i(this).index(); if (0 === e) a.yes ? a.yes(t.index, n) : a.btn1 ? a.btn1(t.index, n) : r.close(t.index); else { var o = a["btn" + (e + 1)] && a["btn" + (e + 1)](t.index, n); o === !1 || r.close(t.index) } }), n.find("." + l[7]).on("click", e), a.shadeClose && i("#layui-layer-shade" + t.index).on("click", function () { r.close(t.index) }), n.find(".layui-layer-min").on("click", function () { var e = a.min && a.min(n); e === !1 || r.min(t.index, a) }), n.find(".layui-layer-max").on("click", function () { i(this).hasClass("layui-layer-maxmin") ? (r.restore(t.index), a.restore && a.restore(n)) : (r.full(t.index, a), setTimeout(function () { a.full && a.full(n) }, 100)) }), a.end && (o.end[t.index] = a.end) }, o.reselect = function () { i.each(i("select"), function (e, t) { var n = i(this); n.parents("." + l[0])[0] || 1 == n.attr("layer") && i("." + l[0]).length < 1 && n.removeAttr("layer").show(), n = null }) }, s.pt.IE6 = function (e) { i("select").each(function (e, t) { var n = i(this); n.parents("." + l[0])[0] || "none" === n.css("display") || n.attr({ layer: "1" }).hide(), n = null }) }, s.pt.openLayer = function () { var e = this; r.zIndex = e.config.zIndex, r.setTop = function (e) { var t = function () { r.zIndex++, e.css("z-index", r.zIndex + 1) }; return r.zIndex = parseInt(e[0].style.zIndex), e.on("mousedown", t), r.zIndex } }, o.record = function (e) { var t = [e.width(), e.height(), e.position().top, e.position().left + parseFloat(e.css("margin-left"))]; e.find(".layui-layer-max").addClass("layui-layer-maxmin"), e.attr({ area: t }) }, o.rescollbar = function (e) { l.html.attr("layer-full") == e && (l.html[0].style.removeProperty ? l.html[0].style.removeProperty("overflow") : l.html[0].style.removeAttribute("overflow"), l.html.removeAttr("layer-full")) }, e.layer = r, r.getChildFrame = function (e, t) { return t = t || i("." + l[4]).attr("times"), i("#" + l[0] + t).find("iframe").contents().find(e) }, r.getFrameIndex = function (e) { return i("#" + e).parents("." + l[4]).attr("times") }, r.iframeAuto = function (e) { if (e) { var t = r.getChildFrame("html", e).outerHeight(), n = i("#" + l[0] + e), a = n.find(l[1]).outerHeight() || 0, o = n.find("." + l[6]).outerHeight() || 0; n.css({ height: t + a + o }), n.find("iframe").css({ height: t }) } }, r.iframeSrc = function (e, t) { i("#" + l[0] + e).find("iframe").attr("src", t) }, r.style = function (e, t, n) { var a = i("#" + l[0] + e), r = a.find(".layui-layer-content"), s = a.attr("type"), f = a.find(l[1]).outerHeight() || 0, c = a.find("." + l[6]).outerHeight() || 0; a.attr("minLeft"); s !== o.type[3] && s !== o.type[4] && (n || (parseFloat(t.width) <= 260 && (t.width = 260), parseFloat(t.height) - f - c <= 64 && (t.height = 64 + f + c)), a.css(t), c = a.find("." + l[6]).outerHeight(), s === o.type[2] ? a.find("iframe").css({ height: parseFloat(t.height) - f - c }) : r.css({ height: parseFloat(t.height) - f - c - parseFloat(r.css("padding-top")) - parseFloat(r.css("padding-bottom")) })) }, r.min = function (e, t) { var a = i("#" + l[0] + e), s = a.find(l[1]).outerHeight() || 0, f = a.attr("minLeft") || 181 * o.minIndex + "px", c = a.css("position"); o.record(a), o.minLeft[0] && (f = o.minLeft[0], o.minLeft.shift()), a.attr("position", c), r.style(e, { width: 180, height: s, left: f, top: n.height() - s, position: "fixed", overflow: "hidden" }, !0), a.find(".layui-layer-min").hide(), "page" === a.attr("type") && a.find(l[4]).hide(), o.rescollbar(e), a.attr("minLeft") || o.minIndex++, a.attr("minLeft", f) }, r.restore = function (e) { var t = i("#" + l[0] + e), n = t.attr("area").split(","); t.attr("type"); r.style(e, { width: parseFloat(n[0]), height: parseFloat(n[1]), top: parseFloat(n[2]), left: parseFloat(n[3]), position: t.attr("position"), overflow: "visible" }, !0), t.find(".layui-layer-max").removeClass("layui-layer-maxmin"), t.find(".layui-layer-min").show(), "page" === t.attr("type") && t.find(l[4]).show(), o.rescollbar(e) }, r.full = function (e) { var t, a = i("#" + l[0] + e); o.record(a), l.html.attr("layer-full") || l.html.css("overflow", "hidden").attr("layer-full", e), clearTimeout(t), t = setTimeout(function () { var t = "fixed" === a.css("position"); r.style(e, { top: t ? 0 : n.scrollTop(), left: t ? 0 : n.scrollLeft(), width: n.width(), height: n.height() }, !0), a.find(".layui-layer-min").hide() }, 100) }, r.title = function (e, t) { var n = i("#" + l[0] + (t || r.index)).find(l[1]); n.html(e) }, r.close = function (e) { var t = i("#" + l[0] + e), n = t.attr("type"), a = "layer-anim-close"; if (t[0]) { var s = "layui-layer-wrap", f = function () { if (n === o.type[1] && "object" === t.attr("conType")) { t.children(":not(." + l[5] + ")").remove(); for (var a = t.find("." + s), r = 0; r < 2; r++) a.unwrap(); a.css("display", a.data("display")).removeClass(s) } else { if (n === o.type[2]) try { var f = i("#" + l[4] + e)[0]; f.contentWindow.document.write(""), f.contentWindow.close(), t.find("." + l[5])[0].removeChild(f) } catch (c) { } t[0].innerHTML = "", t.remove() } "function" == typeof o.end[e] && o.end[e](), delete o.end[e] }; t.data("isOutAnim") && t.addClass(a), i("#layui-layer-moves, #layui-layer-shade" + e).remove(), 6 == r.ie && o.reselect(), o.rescollbar(e), t.attr("minLeft") && (o.minIndex--, o.minLeft.push(t.attr("minLeft"))), r.ie && r.ie < 10 || !t.data("isOutAnim") ? f() : setTimeout(function () { f() }, 200) } }, r.closeAll = function (e) { i.each(i("." + l[0]), function () { var t = i(this), n = e ? t.attr("type") === e : 1; n && r.close(t.attr("times")), n = null }) }; var f = r.cache || {}, c = function (e) { return f.skin ? " " + f.skin + " " + f.skin + "-" + e : "" }; r.prompt = function (e, t) { var a = ""; if (e = e || {}, "function" == typeof e && (t = e), e.area) { var o = e.area; a = 'style="width: ' + o[0] + "; height: " + o[1] + ';"', delete e.area } var s, l = 2 == e.formType ? '<textarea class="layui-layer-input"' + a + ">" + (e.value || "") + "</textarea>" : function () { return '<input type="' + (1 == e.formType ? "password" : "text") + '" class="layui-layer-input" value="' + (e.value || "") + '">' }(), f = e.success; return delete e.success, r.open(i.extend({ type: 1, btn: ["&#x786E;&#x5B9A;", "&#x53D6;&#x6D88;"], content: l, skin: "layui-layer-prompt" + c("prompt"), maxWidth: n.width(), success: function (e) { s = e.find(".layui-layer-input"), s.focus(), "function" == typeof f && f(e) }, resize: !1, yes: function (i) { var n = s.val(); "" === n ? s.focus() : n.length > (e.maxlength || 500) ? r.tips("&#x6700;&#x591A;&#x8F93;&#x5165;" + (e.maxlength || 500) + "&#x4E2A;&#x5B57;&#x6570;", s, { tips: 1 }) : t && t(n, i, s) } }, e)) }, r.tab = function (e) { e = e || {}; var t = e.tab || {}, n = e.success; return delete e.success, r.open(i.extend({ type: 1, skin: "layui-layer-tab" + c("tab"), resize: !1, title: function () { var e = t.length, i = 1, n = ""; if (e > 0) for (n = '<span class="layui-layer-tabnow">' + t[0].title + "</span>"; i < e; i++) n += "<span>" + t[i].title + "</span>"; return n }(), content: '<ul class="layui-layer-tabmain">' + function () { var e = t.length, i = 1, n = ""; if (e > 0) for (n = '<li class="layui-layer-tabli xubox_tab_layer">' + (t[0].content || "no content") + "</li>"; i < e; i++) n += '<li class="layui-layer-tabli">' + (t[i].content || "no  content") + "</li>"; return n }() + "</ul>", success: function (t) { var a = t.find(".layui-layer-title").children(), o = t.find(".layui-layer-tabmain").children(); a.on("mousedown", function (t) { t.stopPropagation ? t.stopPropagation() : t.cancelBubble = !0; var n = i(this), a = n.index(); n.addClass("layui-layer-tabnow").siblings().removeClass("layui-layer-tabnow"), o.eq(a).show().siblings().hide(), "function" == typeof e.change && e.change(a) }), "function" == typeof n && n(t) } }, e)) }, r.photos = function (t, n, a) { function o(e, t, i) { var n = new Image; return n.src = e, n.complete ? t(n) : (n.onload = function () { n.onload = null, t(n) }, void (n.onerror = function (e) { n.onerror = null, i(e) })) } var s = {}; if (t = t || {}, t.photos) { var l = t.photos.constructor === Object, f = l ? t.photos : {}, u = f.data || [], d = f.start || 0; s.imgIndex = (0 | d) + 1, t.img = t.img || "img"; var y = t.success; if (delete t.success, l) { if (0 === u.length) return r.msg("&#x6CA1;&#x6709;&#x56FE;&#x7247;") } else { var p = i(t.photos), h = function () { u = [], p.find(t.img).each(function (e) { var t = i(this); t.attr("layer-index", e), u.push({ alt: t.attr("alt"), pid: t.attr("layer-pid"), src: t.attr("layer-src") || t.attr("src"), thumb: t.attr("src") }) }) }; if (h(), 0 === u.length) return; if (n || p.on("click", t.img, function () { var e = i(this), n = e.attr("layer-index"); r.photos(i.extend(t, { photos: { start: n, data: u, tab: t.tab }, full: t.full }), !0), h() }), !n) return } s.imgprev = function (e) { s.imgIndex--, s.imgIndex < 1 && (s.imgIndex = u.length), s.tabimg(e) }, s.imgnext = function (e, t) { s.imgIndex++, s.imgIndex > u.length && (s.imgIndex = 1, t) || s.tabimg(e) }, s.keyup = function (e) { if (!s.end) { var t = e.keyCode; e.preventDefault(), 37 === t ? s.imgprev(!0) : 39 === t ? s.imgnext(!0) : 27 === t && r.close(s.index) } }, s.tabimg = function (e) { if (!(u.length <= 1)) return f.start = s.imgIndex - 1, r.close(s.index), r.photos(t, !0, e) }, s.event = function () { s.bigimg.hover(function () { s.imgsee.show() }, function () { s.imgsee.hide() }), s.bigimg.find(".layui-layer-imgprev").on("click", function (e) { e.preventDefault(), s.imgprev() }), s.bigimg.find(".layui-layer-imgnext").on("click", function (e) { e.preventDefault(), s.imgnext() }), i(document).on("keyup", s.keyup) }, s.loadi = r.load(1, { shade: !("shade" in t) && .9, scrollbar: !1 }), o(u[d].src, function (n) { r.close(s.loadi), s.index = r.open(i.extend({ type: 1, id: "layui-layer-photos", area: function () { var a = [n.width, n.height], o = [i(e).width() - 100, i(e).height() - 100]; if (!t.full && (a[0] > o[0] || a[1] > o[1])) { var r = [a[0] / o[0], a[1] / o[1]]; r[0] > r[1] ? (a[0] = a[0] / r[0], a[1] = a[1] / r[0]) : r[0] < r[1] && (a[0] = a[0] / r[1], a[1] = a[1] / r[1]) } return [a[0] + "px", a[1] + "px"] }(), title: !1, shade: .9, shadeClose: !0, closeBtn: !1, move: ".layui-layer-phimg img", moveType: 1, scrollbar: !1, moveOut: !0, isOutAnim: !1, skin: "layui-layer-photos" + c("photos"), content: '<div class="layui-layer-phimg"><img src="' + u[d].src + '" alt="' + (u[d].alt || "") + '" layer-pid="' + u[d].pid + '"><div class="layui-layer-imgsee">' + (u.length > 1 ? '<span class="layui-layer-imguide"><a href="javascript:;" class="layui-layer-iconext layui-layer-imgprev"></a><a href="javascript:;" class="layui-layer-iconext layui-layer-imgnext"></a></span>' : "") + '<div class="layui-layer-imgbar" style="display:' + (a ? "block" : "") + '"><span class="layui-layer-imgtit"><a href="javascript:;">' + (u[d].alt || "") + "</a><em>" + s.imgIndex + "/" + u.length + "</em></span></div></div></div>", success: function (e, i) { s.bigimg = e.find(".layui-layer-phimg"), s.imgsee = e.find(".layui-layer-imguide,.layui-layer-imgbar"), s.event(e), t.tab && t.tab(u[d], e), "function" == typeof y && y(e) }, end: function () { s.end = !0, i(document).off("keyup", s.keyup) } }, t)) }, function () { r.close(s.loadi), r.msg("&#x5F53;&#x524D;&#x56FE;&#x7247;&#x5730;&#x5740;&#x5F02;&#x5E38;<br>&#x662F;&#x5426;&#x7EE7;&#x7EED;&#x67E5;&#x770B;&#x4E0B;&#x4E00;&#x5F20;&#xFF1F;", { time: 3e4, btn: ["&#x4E0B;&#x4E00;&#x5F20;", "&#x4E0D;&#x770B;&#x4E86;"], yes: function () { u.length > 1 && s.imgnext(!0, !0) } }) }) } }, o.run = function (t) { i = t, n = i(e), l.html = i("html"), r.open = function (e) { var t = new s(e); return t.index } }, e.layui && layui.define ? (r.ready(), layui.define("jquery", function (t) { r.path = layui.cache.dir, o.run(layui.jquery), e.layer = r, t("layer", r) })) : "function" == typeof define && define.amd ? define(["jquery"], function () { return o.run(e.jQuery), r }) : function () { o.run(e.jQuery), r.ready() }() }(window);
// QQ表情插件
(function ($) { $.fn.qqFace = function (options) { var defaults = { id: 'facebox', path: 'face/', assign: 'content', tip: 'em_' }; var option = $.extend(defaults, options); var assign = $('#' + option.assign); var id = option.id; var path = option.path; var tip = option.tip; if (assign.length <= 0) { alert('缺少表情赋值对象。'); return false } $(this).click(function (e) { var strFace, labFace; if ($('#' + id).length <= 0) { strFace = '<div id="' + id + '" style="position:absolute;display:none;z-index:1000;" class="qqFace"><table border="0" cellspacing="0" cellpadding="0"><tr>'; for (var i = 701; i <= 756; i += 1) { labFace = '[' + tip + i + ']'; strFace += '<td><img src="' + path + i + '.png" onclick="$(\'#' + option.assign + '\').setCaret();$(\'#' + option.assign + '\').insertAtCaret(\'' + labFace + '\');" /></td>'; if (i % 14 == 0) { strFace += '</tr><tr>' } } strFace += '</tr></table></div>' } $(this).parent().append(strFace); var offset = $(this).position(); var top = offset.top + $(this).outerHeight(); $('#' + id).css('top', top); $('#' + id).css('left', offset.left); $('#' + id).show(); e.stopPropagation() }); $(document).click(function () { $('#' + id).hide(); $('#' + id).remove() }) } })(jQuery); jQuery.extend({ unselectContents: function () { if (window.getSelection) { window.getSelection().removeAllRanges() } else if (document.selection) { document.selection.empty() } } }); jQuery.fn.extend({
    selectContents: function () { $(this).each(function (i) { var node = this; var selection, range, doc, win; if ((doc = node.ownerDocument) && (win = doc.defaultView) && typeof win.getSelection != 'undefined' && typeof doc.createRange != 'undefined' && (selection = window.getSelection()) && typeof selection.removeAllRanges != 'undefined') { range = doc.createRange(); range.selectNode(node); if (i == 0) { selection.removeAllRanges() } selection.addRange(range) } else if (document.body && typeof document.body.createTextRange != 'undefined' && (range = document.body.createTextRange())) { range.moveToElementText(node); range.select() } }) }, setCaret: function () { if (!$.browser || !$.browser.msie) { return } var initSetCaret = function () { var textObj = $(this).get(0); textObj.caretPos = document.selection.createRange().duplicate() }; $(this).click(initSetCaret).select(initSetCaret).keyup(initSetCaret) }, insertAtCaret: function (textFeildValue) { var textObj = $(this).get(0); if (document.all && textObj.createTextRange && textObj.caretPos) { var caretPos = textObj.caretPos; caretPos.text = caretPos.text.charAt(caretPos.text.length - 1) == '' ? textFeildValue + '' : textFeildValue } else if (textObj.setSelectionRange) {if (textObj.value.length < 193) { var rangeStart = textObj.selectionStart; var rangeEnd = textObj.selectionEnd; var tempStr1 = textObj.value.substring(0, rangeStart); var tempStr2 = textObj.value.substring(rangeEnd); textObj.value = tempStr1 + textFeildValue + tempStr2; textObj.focus(); var len = textFeildValue.length; textObj.setSelectionRange(rangeStart + len, rangeStart + len); textObj.blur(); $(this).trigger('input'); $(this).trigger('change'); } else if (textObj.value.length > 192 && textObj.value.length < 200) {var str = "一个表情占8个字符,现在还可以输入" + (200 - textObj.value.length) + "个字符"; layer.msg(str);}} else { textObj.value += textFeildValue; $(this).trigger('input'); $(this).trigger('change') }}
});
//录音
(function (exports) { var Util = { init: function () { navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia; window.AudioContext = window.AudioContext || window.webkitAudioContext }, log: function () { console.log.apply(console, arguments) } }; var Recorder = function (config) { var _this = this; config = config || {}; config.sampleRate = config.sampleRate || 44100; config.bitRate = config.bitRate || 128; Util.init(); if (navigator.getUserMedia) { navigator.getUserMedia({ audio: true }, function (stream) { var context = new AudioContext(), microphone = context.createMediaStreamSource(stream), processor = context.createScriptProcessor(16384, 1, 1), successCallback, errorCallback; config.sampleRate = context.sampleRate; processor.onaudioprocess = function (event) { var array = event.inputBuffer.getChannelData(0); realTimeWorker.postMessage({ cmd: 'encode', buf: array }) }; var jsUrl = '/Content/js/worker.js'; var realTimeWorker = new Worker(jsUrl); realTimeWorker.onmessage = function (e) { switch (e.data.cmd) { case 'init': Util.log('初始化成功'); if (config.success) { config.success() } break; case 'end': if (successCallback) { var blob = new Blob(e.data.buf, { type: 'audio/mp3' }); successCallback(blob); Util.log('MP3大小：' + blob.size + '%cB', 'color:#0000EE') } break; case 'error': Util.log('错误信息：' + e.data.error); if (errorCallback) { errorCallback(e.data.error) } break; default: Util.log('未知信息：' + e.data) } }; _this.start = function () { if (processor && microphone) { microphone.connect(processor); processor.connect(context.destination); Util.log('开始录音') } }; _this.stop = function () { if (processor && microphone) { microphone.disconnect(); processor.disconnect(); Util.log('录音结束') } }; _this.getBlob = function (onSuccess, onError) { successCallback = onSuccess; errorCallback = onError; realTimeWorker.postMessage({ cmd: 'finish' }) }; realTimeWorker.postMessage({ cmd: 'init', config: { sampleRate: config.sampleRate, bitRate: config.bitRate } }) }, function (error) { var msg; switch (error.code || error.name) { case 'PermissionDeniedError': case 'PERMISSION_DENIED': case 'NotAllowedError': msg = '用户拒绝访问麦克风'; break; case 'NOT_SUPPORTED_ERROR': case 'NotSupportedError': msg = '浏览器不支持麦克风'; break; case 'MANDATORY_UNSATISFIED_ERROR': case 'MandatoryUnsatisfiedError': msg = '找不到麦克风设备'; break; default: msg = '无法打开麦克风，异常信息:' + (error.code || error.name); break } Util.log(msg); if (config.error) { config.error(msg) } }) } else { Util.log('当前浏览器不支持录音功能'); if (config.fix) { config.fix('当前浏览器不支持录音功能') } } }; exports.Recorder = Recorder })(window);
//美化滚动条
/*! Copyright (c) 2013 Brandon Aaron (http://brandon.aaron.sh)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Version: 3.1.12
 *
 * Requires: jQuery 1.2.2+
 */
!function (a) { "function" == typeof define && define.amd ? define(["jquery"], a) : "object" == typeof exports ? module.exports = a : a(jQuery) }(function (a) { function b(b) { var g = b || window.event, h = i.call(arguments, 1), j = 0, l = 0, m = 0, n = 0, o = 0, p = 0; if (b = a.event.fix(g), b.type = "mousewheel", "detail" in g && (m = -1 * g.detail), "wheelDelta" in g && (m = g.wheelDelta), "wheelDeltaY" in g && (m = g.wheelDeltaY), "wheelDeltaX" in g && (l = -1 * g.wheelDeltaX), "axis" in g && g.axis === g.HORIZONTAL_AXIS && (l = -1 * m, m = 0), j = 0 === m ? l : m, "deltaY" in g && (m = -1 * g.deltaY, j = m), "deltaX" in g && (l = g.deltaX, 0 === m && (j = -1 * l)), 0 !== m || 0 !== l) { if (1 === g.deltaMode) { var q = a.data(this, "mousewheel-line-height"); j *= q, m *= q, l *= q } else if (2 === g.deltaMode) { var r = a.data(this, "mousewheel-page-height"); j *= r, m *= r, l *= r } if (n = Math.max(Math.abs(m), Math.abs(l)), (!f || f > n) && (f = n, d(g, n) && (f /= 40)), d(g, n) && (j /= 40, l /= 40, m /= 40), j = Math[j >= 1 ? "floor" : "ceil"](j / f), l = Math[l >= 1 ? "floor" : "ceil"](l / f), m = Math[m >= 1 ? "floor" : "ceil"](m / f), k.settings.normalizeOffset && this.getBoundingClientRect) { var s = this.getBoundingClientRect(); o = b.clientX - s.left, p = b.clientY - s.top } return b.deltaX = l, b.deltaY = m, b.deltaFactor = f, b.offsetX = o, b.offsetY = p, b.deltaMode = 0, h.unshift(b, j, l, m), e && clearTimeout(e), e = setTimeout(c, 200), (a.event.dispatch || a.event.handle).apply(this, h) } } function c() { f = null } function d(a, b) { return k.settings.adjustOldDeltas && "mousewheel" === a.type && b % 120 === 0 } var e, f, g = ["wheel", "mousewheel", "DOMMouseScroll", "MozMousePixelScroll"], h = "onwheel" in document || document.documentMode >= 9 ? ["wheel"] : ["mousewheel", "DomMouseScroll", "MozMousePixelScroll"], i = Array.prototype.slice; if (a.event.fixHooks) for (var j = g.length; j;) a.event.fixHooks[g[--j]] = a.event.mouseHooks; var k = a.event.special.mousewheel = { version: "3.1.12", setup: function () { if (this.addEventListener) for (var c = h.length; c;) this.addEventListener(h[--c], b, !1); else this.onmousewheel = b; a.data(this, "mousewheel-line-height", k.getLineHeight(this)), a.data(this, "mousewheel-page-height", k.getPageHeight(this)) }, teardown: function () { if (this.removeEventListener) for (var c = h.length; c;) this.removeEventListener(h[--c], b, !1); else this.onmousewheel = null; a.removeData(this, "mousewheel-line-height"), a.removeData(this, "mousewheel-page-height") }, getLineHeight: function (b) { var c = a(b), d = c["offsetParent" in a.fn ? "offsetParent" : "parent"](); return d.length || (d = a("body")), parseInt(d.css("fontSize"), 10) || parseInt(c.css("fontSize"), 10) || 16 }, getPageHeight: function (b) { return a(b).height() }, settings: { adjustOldDeltas: !0, normalizeOffset: !0 } }; a.fn.extend({ mousewheel: function (a) { return a ? this.bind("mousewheel", a) : this.trigger("mousewheel") }, unmousewheel: function (a) { return this.unbind("mousewheel", a) } }) });
/* == malihu jquery custom scrollbar plugin ==
Version: 3.0.9
Plugin URI: http://manos.malihu.gr/jquery-custom-content-scroller
Author: malihu
Author URI: http://manos.malihu.gr
License: MIT License (MIT) */
/* Copyright 2010 Manos Malihutsakis (email: manos@malihu.gr)

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE. */
/* The code below is fairly long, fully commented and should be normally used in development.
For production, use either the minified jquery.mCustomScrollbar.min.js script or
the production-ready jquery.mCustomScrollbar.concat.min.js which contains the plugin
and dependencies (minified). */
(function (factory) { if (typeof module !== "undefined" && module.exports) { module.exports = factory } else { factory(jQuery, window, document) } }(function ($) { (function (init) { var _rjs = typeof define === "function" && define.amd, _njs = typeof module !== "undefined" && module.exports, _dlp = ("https:" == document.location.protocol) ? "https:" : "http:"; if (!_rjs) { if (_njs) { require("jquery-mousewheel")($) } else { } } init() }(function () { var pluginNS = "mCustomScrollbar", pluginPfx = "mCS", defaultSelector = ".mCustomScrollbar", defaults = { setTop: 0, setLeft: 0, axis: "y", scrollbarPosition: "inside", scrollInertia: 950, autoDraggerLength: true, alwaysShowScrollbar: 0, snapOffset: 0, mouseWheel: { enable: true, scrollAmount: "auto", axis: "y", deltaFactor: "auto", disableOver: ["select", "option", "keygen", "datalist", "textarea"] }, scrollButtons: { scrollType: "stepless", scrollAmount: "auto" }, keyboard: { enable: true, scrollType: "stepless", scrollAmount: "auto" }, contentTouchScroll: 25, advanced: { autoScrollOnFocus: "input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']", updateOnContentResize: true, updateOnImageLoad: true, autoUpdateTimeout: 60 }, theme: "light", callbacks: { onTotalScrollOffset: 0, onTotalScrollBackOffset: 0, alwaysTriggerOffsets: true } }, totalInstances = 0, liveTimers = {}, oldIE = (window.attachEvent && !window.addEventListener) ? 1 : 0, touchActive = false, touchable, classes = ["mCSB_dragger_onDrag", "mCSB_scrollTools_onDrag", "mCS_img_loaded", "mCS_disabled", "mCS_destroyed", "mCS_no_scrollbar", "mCS-autoHide", "mCS-dir-rtl", "mCS_no_scrollbar_y", "mCS_no_scrollbar_x", "mCS_y_hidden", "mCS_x_hidden", "mCSB_draggerContainer", "mCSB_buttonUp", "mCSB_buttonDown", "mCSB_buttonLeft", "mCSB_buttonRight"], methods = { init: function (options) { var options = $.extend(true, {}, defaults, options), selector = _selector.call(this); if (options.live) { var liveSelector = options.liveSelector || this.selector || defaultSelector, $liveSelector = $(liveSelector); if (options.live === "off") { removeLiveTimers(liveSelector); return } liveTimers[liveSelector] = setTimeout(function () { $liveSelector.mCustomScrollbar(options); if (options.live === "once" && $liveSelector.length) { removeLiveTimers(liveSelector) } }, 500) } else { removeLiveTimers(liveSelector) } options.setWidth = (options.set_width) ? options.set_width : options.setWidth; options.setHeight = (options.set_height) ? options.set_height : options.setHeight; options.axis = (options.horizontalScroll) ? "x" : _findAxis(options.axis); options.scrollInertia = options.scrollInertia > 0 && options.scrollInertia < 17 ? 17 : options.scrollInertia; if (typeof options.mouseWheel !== "object" && options.mouseWheel == true) { options.mouseWheel = { enable: true, scrollAmount: "auto", axis: "y", preventDefault: false, deltaFactor: "auto", normalizeDelta: false, invert: false } } options.mouseWheel.scrollAmount = !options.mouseWheelPixels ? options.mouseWheel.scrollAmount : options.mouseWheelPixels; options.mouseWheel.normalizeDelta = !options.advanced.normalizeMouseWheelDelta ? options.mouseWheel.normalizeDelta : options.advanced.normalizeMouseWheelDelta; options.scrollButtons.scrollType = _findScrollButtonsType(options.scrollButtons.scrollType); _theme(options); return $(selector).each(function () { var $this = $(this); if (!$this.data(pluginPfx)) { $this.data(pluginPfx, { idx: ++totalInstances, opt: options, scrollRatio: { y: null, x: null }, overflowed: null, contentReset: { y: null, x: null }, bindEvents: false, tweenRunning: false, sequential: {}, langDir: $this.css("direction"), cbOffsets: null, trigger: null }); var d = $this.data(pluginPfx), o = d.opt, htmlDataAxis = $this.data("mcs-axis"), htmlDataSbPos = $this.data("mcs-scrollbar-position"), htmlDataTheme = $this.data("mcs-theme"); if (htmlDataAxis) { o.axis = htmlDataAxis } if (htmlDataSbPos) { o.scrollbarPosition = htmlDataSbPos } if (htmlDataTheme) { o.theme = htmlDataTheme; _theme(o); } _pluginMarkup.call(this); $("#mCSB_" + d.idx + "_container img:not(." + classes[2] + ")").addClass(classes[2]); methods.update.call(null, $this); } }) }, update: function (el, cb) { var selector = el || _selector.call(this); return $(selector).each(function () { var $this = $(this); if ($this.data(pluginPfx)) { var d = $this.data(pluginPfx), o = d.opt, mCSB_container = $("#mCSB_" + d.idx + "_container"), mCSB_dragger = [$("#mCSB_" + d.idx + "_dragger_vertical"), $("#mCSB_" + d.idx + "_dragger_horizontal")]; if (!mCSB_container.length) { return } if (d.tweenRunning) { _stop($this) } if ($this.hasClass(classes[3])) { $this.removeClass(classes[3]) } if ($this.hasClass(classes[4])) { $this.removeClass(classes[4]) } _maxHeight.call(this); _expandContentHorizontally.call(this); if (o.axis !== "y" && !o.advanced.autoExpandHorizontalScroll) { mCSB_container.css("width", _contentWidth(mCSB_container.children())) } d.overflowed = _overflowed.call(this); _scrollbarVisibility.call(this); if (o.autoDraggerLength) { _setDraggerLength.call(this) } _scrollRatio.call(this); _bindEvents.call(this); var to = [Math.abs(mCSB_container[0].offsetTop), Math.abs(mCSB_container[0].offsetLeft)]; if (o.axis !== "x") { if (!d.overflowed[0]) { _resetContentPosition.call(this); if (o.axis === "y") { _unbindEvents.call(this) } else if (o.axis === "yx" && d.overflowed[1]) { _scrollTo($this, to[1].toString(), { dir: "x", dur: 0, overwrite: "none" }) } } else if (mCSB_dragger[0].height() > mCSB_dragger[0].parent().height()) { _resetContentPosition.call(this); } else { _scrollTo($this, to[0].toString(), { dir: "y", dur: 0, overwrite: "none" }); d.contentReset.y = null } } if (o.axis !== "y") { if (!d.overflowed[1]) { _resetContentPosition.call(this); if (o.axis === "x") { _unbindEvents.call(this) } else if (o.axis === "yx" && d.overflowed[0]) { _scrollTo($this, to[0].toString(), { dir: "y", dur: 0, overwrite: "none" }) } } else if (mCSB_dragger[1].width() > mCSB_dragger[1].parent().width()) { _resetContentPosition.call(this); } else { _scrollTo($this, to[1].toString(), { dir: "x", dur: 0, overwrite: "none" }); d.contentReset.x = null } } if (cb && d) { if (cb === 2 && o.callbacks.onImageLoad && typeof o.callbacks.onImageLoad === "function") { o.callbacks.onImageLoad.call(this) } else if (cb === 3 && o.callbacks.onSelectorChange && typeof o.callbacks.onSelectorChange === "function") { o.callbacks.onSelectorChange.call(this) } else if (o.callbacks.onUpdate && typeof o.callbacks.onUpdate === "function") { o.callbacks.onUpdate.call(this) } } _autoUpdate.call(this); } }) }, scrollTo: function (val, options) { if (typeof val == "undefined" || val == null) { return } var selector = _selector.call(this); return $(selector).each(function () { var $this = $(this); if ($this.data(pluginPfx)) { var d = $this.data(pluginPfx), o = d.opt, methodDefaults = { trigger: "external", scrollInertia: o.scrollInertia, scrollEasing: "mcsEaseInOut", moveDragger: false, timeout: 60, callbacks: true, onStart: true, onUpdate: true, onComplete: true }, methodOptions = $.extend(true, {}, methodDefaults, options), to = _arr.call(this, val), dur = methodOptions.scrollInertia > 0 && methodOptions.scrollInertia < 17 ? 17 : methodOptions.scrollInertia; to[0] = _to.call(this, to[0], "y"); to[1] = _to.call(this, to[1], "x"); if (methodOptions.moveDragger) { to[0] *= d.scrollRatio.y; to[1] *= d.scrollRatio.x } methodOptions.dur = dur; setTimeout(function () { if (to[0] !== null && typeof to[0] !== "undefined" && o.axis !== "x" && d.overflowed[0]) { methodOptions.dir = "y"; methodOptions.overwrite = "all"; _scrollTo($this, to[0].toString(), methodOptions) } if (to[1] !== null && typeof to[1] !== "undefined" && o.axis !== "y" && d.overflowed[1]) { methodOptions.dir = "x"; methodOptions.overwrite = "none"; _scrollTo($this, to[1].toString(), methodOptions) } }, methodOptions.timeout) } }) }, stop: function () { var selector = _selector.call(this); return $(selector).each(function () { var $this = $(this); if ($this.data(pluginPfx)) { _stop($this) } }) }, disable: function (r) { var selector = _selector.call(this); return $(selector).each(function () { var $this = $(this); if ($this.data(pluginPfx)) { var d = $this.data(pluginPfx); _autoUpdate.call(this, "remove"); _unbindEvents.call(this); if (r) { _resetContentPosition.call(this) } _scrollbarVisibility.call(this, true); $this.addClass(classes[3]); } }) }, destroy: function () { var selector = _selector.call(this); return $(selector).each(function () { var $this = $(this); if ($this.data(pluginPfx)) { var d = $this.data(pluginPfx), o = d.opt, mCustomScrollBox = $("#mCSB_" + d.idx), mCSB_container = $("#mCSB_" + d.idx + "_container"), scrollbar = $(".mCSB_" + d.idx + "_scrollbar"); if (o.live) { removeLiveTimers(o.liveSelector || $(selector).selector) } _autoUpdate.call(this, "remove"); _unbindEvents.call(this); _resetContentPosition.call(this); $this.removeData(pluginPfx); _delete(this, "mcs"); scrollbar.remove(); mCSB_container.find("img." + classes[2]).removeClass(classes[2]); mCustomScrollBox.replaceWith(mCSB_container.contents()); $this.removeClass(pluginNS + " _" + pluginPfx + "_" + d.idx + " " + classes[6] + " " + classes[7] + " " + classes[5] + " " + classes[3]).addClass(classes[4]) } }) } }, _selector = function () { return (typeof $(this) !== "object" || $(this).length < 1) ? defaultSelector : this }, _theme = function (obj) { var fixedSizeScrollbarThemes = ["rounded", "rounded-dark", "rounded-dots", "rounded-dots-dark"], nonExpandedScrollbarThemes = ["rounded-dots", "rounded-dots-dark", "3d", "3d-dark", "3d-thick", "3d-thick-dark", "inset", "inset-dark", "inset-2", "inset-2-dark", "inset-3", "inset-3-dark"], disabledScrollButtonsThemes = ["minimal", "minimal-dark"], enabledAutoHideScrollbarThemes = ["minimal", "minimal-dark"], scrollbarPositionOutsideThemes = ["minimal", "minimal-dark"]; obj.autoDraggerLength = $.inArray(obj.theme, fixedSizeScrollbarThemes) > -1 ? false : obj.autoDraggerLength; obj.autoExpandScrollbar = $.inArray(obj.theme, nonExpandedScrollbarThemes) > -1 ? false : obj.autoExpandScrollbar; obj.scrollButtons.enable = $.inArray(obj.theme, disabledScrollButtonsThemes) > -1 ? false : obj.scrollButtons.enable; obj.autoHideScrollbar = $.inArray(obj.theme, enabledAutoHideScrollbarThemes) > -1 ? true : obj.autoHideScrollbar; obj.scrollbarPosition = $.inArray(obj.theme, scrollbarPositionOutsideThemes) > -1 ? "outside" : obj.scrollbarPosition }, removeLiveTimers = function (selector) { if (liveTimers[selector]) { clearTimeout(liveTimers[selector]); _delete(liveTimers, selector) } }, _findAxis = function (val) { return (val === "yx" || val === "xy" || val === "auto") ? "yx" : (val === "x" || val === "horizontal") ? "x" : "y" }, _findScrollButtonsType = function (val) { return (val === "stepped" || val === "pixels" || val === "step" || val === "click") ? "stepped" : "stepless" }, _pluginMarkup = function () { var $this = $(this), d = $this.data(pluginPfx), o = d.opt, expandClass = o.autoExpandScrollbar ? " " + classes[1] + "_expand" : "", scrollbar = ["<div id='mCSB_" + d.idx + "_scrollbar_vertical' class='mCSB_scrollTools mCSB_" + d.idx + "_scrollbar mCS-" + o.theme + " mCSB_scrollTools_vertical" + expandClass + "'><div class='" + classes[12] + "'><div id='mCSB_" + d.idx + "_dragger_vertical' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>", "<div id='mCSB_" + d.idx + "_scrollbar_horizontal' class='mCSB_scrollTools mCSB_" + d.idx + "_scrollbar mCS-" + o.theme + " mCSB_scrollTools_horizontal" + expandClass + "'><div class='" + classes[12] + "'><div id='mCSB_" + d.idx + "_dragger_horizontal' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>"], wrapperClass = o.axis === "yx" ? "mCSB_vertical_horizontal" : o.axis === "x" ? "mCSB_horizontal" : "mCSB_vertical", scrollbars = o.axis === "yx" ? scrollbar[0] + scrollbar[1] : o.axis === "x" ? scrollbar[1] : scrollbar[0], contentWrapper = o.axis === "yx" ? "<div id='mCSB_" + d.idx + "_container_wrapper' class='mCSB_container_wrapper' />" : "", autoHideClass = o.autoHideScrollbar ? " " + classes[6] : "", scrollbarDirClass = (o.axis !== "x" && d.langDir === "rtl") ? " " + classes[7] : ""; if (o.setWidth) { $this.css("width", o.setWidth) } if (o.setHeight) { $this.css("height", o.setHeight) } o.setLeft = (o.axis !== "y" && d.langDir === "rtl") ? "989999px" : o.setLeft; $this.addClass(pluginNS + " _" + pluginPfx + "_" + d.idx + autoHideClass + scrollbarDirClass).wrapInner("<div id='mCSB_" + d.idx + "' class='mCustomScrollBox mCS-" + o.theme + " " + wrapperClass + "'><div id='mCSB_" + d.idx + "_container' class='mCSB_container' style='position:relative; top:" + o.setTop + "; left:" + o.setLeft + ";' dir=" + d.langDir + " /></div>"); var mCustomScrollBox = $("#mCSB_" + d.idx), mCSB_container = $("#mCSB_" + d.idx + "_container"); if (o.axis !== "y" && !o.advanced.autoExpandHorizontalScroll) { mCSB_container.css("width", _contentWidth(mCSB_container.children())) } if (o.scrollbarPosition === "outside") { if ($this.css("position") === "static") { $this.css("position", "relative") } $this.css("overflow", "visible"); mCustomScrollBox.addClass("mCSB_outside").after(scrollbars) } else { mCustomScrollBox.addClass("mCSB_inside").append(scrollbars); mCSB_container.wrap(contentWrapper) } _scrollButtons.call(this); var mCSB_dragger = [$("#mCSB_" + d.idx + "_dragger_vertical"), $("#mCSB_" + d.idx + "_dragger_horizontal")]; mCSB_dragger[0].css("min-height", mCSB_dragger[0].height()); mCSB_dragger[1].css("min-width", mCSB_dragger[1].width()) }, _contentWidth = function (el) { return Math.max.apply(Math, el.map(function () { return $(this).outerWidth(true) }).get()) }, _expandContentHorizontally = function () { var $this = $(this), d = $this.data(pluginPfx), o = d.opt, mCSB_container = $("#mCSB_" + d.idx + "_container"); if (o.advanced.autoExpandHorizontalScroll && o.axis !== "y") { mCSB_container.css({ "position": "absolute", "width": "auto" }).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({ "width": (Math.ceil(mCSB_container[0].getBoundingClientRect().right + 0.4) - Math.floor(mCSB_container[0].getBoundingClientRect().left)), "position": "relative" }).unwrap() } }, _scrollButtons = function () { var $this = $(this), d = $this.data(pluginPfx), o = d.opt, mCSB_scrollTools = $(".mCSB_" + d.idx + "_scrollbar:first"), tabindex = !_isNumeric(o.scrollButtons.tabindex) ? "" : "tabindex='" + o.scrollButtons.tabindex + "'", btnHTML = ["<a href='#' class='" + classes[13] + "' oncontextmenu='return false;' " + tabindex + " />", "<a href='#' class='" + classes[14] + "' oncontextmenu='return false;' " + tabindex + " />", "<a href='#' class='" + classes[15] + "' oncontextmenu='return false;' " + tabindex + " />", "<a href='#' class='" + classes[16] + "' oncontextmenu='return false;' " + tabindex + " />"], btn = [(o.axis === "x" ? btnHTML[2] : btnHTML[0]), (o.axis === "x" ? btnHTML[3] : btnHTML[1]), btnHTML[2], btnHTML[3]]; if (o.scrollButtons.enable) { mCSB_scrollTools.prepend(btn[0]).append(btn[1]).next(".mCSB_scrollTools").prepend(btn[2]).append(btn[3]) } }, _maxHeight = function () { var $this = $(this), d = $this.data(pluginPfx), mCustomScrollBox = $("#mCSB_" + d.idx), mh = $this.css("max-height") || "none", pct = mh.indexOf("%") !== -1, bs = $this.css("box-sizing"); if (mh !== "none") { var val = pct ? $this.parent().height() * parseInt(mh) / 100 : parseInt(mh); if (bs === "border-box") { val -= (($this.innerHeight() - $this.height()) + ($this.outerHeight() - $this.innerHeight())) } mCustomScrollBox.css("max-height", Math.round(val)) } }, _setDraggerLength = function () { var $this = $(this), d = $this.data(pluginPfx), mCustomScrollBox = $("#mCSB_" + d.idx), mCSB_container = $("#mCSB_" + d.idx + "_container"), mCSB_dragger = [$("#mCSB_" + d.idx + "_dragger_vertical"), $("#mCSB_" + d.idx + "_dragger_horizontal")], ratio = [mCustomScrollBox.height() / mCSB_container.outerHeight(false), mCustomScrollBox.width() / mCSB_container.outerWidth(false)], l = [parseInt(mCSB_dragger[0].css("min-height")), Math.round(ratio[0] * mCSB_dragger[0].parent().height()), parseInt(mCSB_dragger[1].css("min-width")), Math.round(ratio[1] * mCSB_dragger[1].parent().width())], h = oldIE && (l[1] < l[0]) ? l[0] : l[1], w = oldIE && (l[3] < l[2]) ? l[2] : l[3]; mCSB_dragger[0].css({ "height": h, "max-height": (mCSB_dragger[0].parent().height() - 10) }).find(".mCSB_dragger_bar").css({ "line-height": l[0] + "px" }); mCSB_dragger[1].css({ "width": w, "max-width": (mCSB_dragger[1].parent().width() - 10) }) }, _scrollRatio = function () { var $this = $(this), d = $this.data(pluginPfx), mCustomScrollBox = $("#mCSB_" + d.idx), mCSB_container = $("#mCSB_" + d.idx + "_container"), mCSB_dragger = [$("#mCSB_" + d.idx + "_dragger_vertical"), $("#mCSB_" + d.idx + "_dragger_horizontal")], scrollAmount = [mCSB_container.outerHeight(false) - mCustomScrollBox.height(), mCSB_container.outerWidth(false) - mCustomScrollBox.width()], ratio = [scrollAmount[0] / (mCSB_dragger[0].parent().height() - mCSB_dragger[0].height()), scrollAmount[1] / (mCSB_dragger[1].parent().width() - mCSB_dragger[1].width())]; d.scrollRatio = { y: ratio[0], x: ratio[1] } }, _onDragClasses = function (el, action, xpnd) { var expandClass = xpnd ? classes[0] + "_expanded" : "", scrollbar = el.closest(".mCSB_scrollTools"); if (action === "active") { el.toggleClass(classes[0] + " " + expandClass); scrollbar.toggleClass(classes[1]); el[0]._draggable = el[0]._draggable ? 0 : 1 } else { if (!el[0]._draggable) { if (action === "hide") { el.removeClass(classes[0]); scrollbar.removeClass(classes[1]) } else { el.addClass(classes[0]); scrollbar.addClass(classes[1]) } } } }, _overflowed = function () { var $this = $(this), d = $this.data(pluginPfx), mCustomScrollBox = $("#mCSB_" + d.idx), mCSB_container = $("#mCSB_" + d.idx + "_container"), contentHeight = d.overflowed == null ? mCSB_container.height() : mCSB_container.outerHeight(false), contentWidth = d.overflowed == null ? mCSB_container.width() : mCSB_container.outerWidth(false); return [contentHeight > mCustomScrollBox.height(), contentWidth > mCustomScrollBox.width()] }, _resetContentPosition = function () { var $this = $(this), d = $this.data(pluginPfx), o = d.opt, mCustomScrollBox = $("#mCSB_" + d.idx), mCSB_container = $("#mCSB_" + d.idx + "_container"), mCSB_dragger = [$("#mCSB_" + d.idx + "_dragger_vertical"), $("#mCSB_" + d.idx + "_dragger_horizontal")]; _stop($this); if ((o.axis !== "x" && !d.overflowed[0]) || (o.axis === "y" && d.overflowed[0])) { mCSB_dragger[0].add(mCSB_container).css("top", 0); _scrollTo($this, "_resetY") } if ((o.axis !== "y" && !d.overflowed[1]) || (o.axis === "x" && d.overflowed[1])) { var cx = dx = 0; if (d.langDir === "rtl") { cx = mCustomScrollBox.width() - mCSB_container.outerWidth(false); dx = Math.abs(cx / d.scrollRatio.x) } mCSB_container.css("left", cx); mCSB_dragger[1].css("left", dx); _scrollTo($this, "_resetX") } }, _bindEvents = function () { var $this = $(this), d = $this.data(pluginPfx), o = d.opt; if (!d.bindEvents) { _draggable.call(this); if (o.contentTouchScroll) { _contentDraggable.call(this) } _selectable.call(this); if (o.mouseWheel.enable) { function _mwt() { mousewheelTimeout = setTimeout(function () { if (!$.event.special.mousewheel) { _mwt() } else { clearTimeout(mousewheelTimeout); _mousewheel.call($this[0]) } }, 100) } var mousewheelTimeout; _mwt() } _draggerRail.call(this); _wrapperScroll.call(this); if (o.advanced.autoScrollOnFocus) { _focus.call(this) } if (o.scrollButtons.enable) { _buttons.call(this) } if (o.keyboard.enable) { _keyboard.call(this) } d.bindEvents = true } }, _unbindEvents = function () { var $this = $(this), d = $this.data(pluginPfx), o = d.opt, namespace = pluginPfx + "_" + d.idx, sb = ".mCSB_" + d.idx + "_scrollbar", sel = $("#mCSB_" + d.idx + ",#mCSB_" + d.idx + "_container,#mCSB_" + d.idx + "_container_wrapper," + sb + " ." + classes[12] + ",#mCSB_" + d.idx + "_dragger_vertical,#mCSB_" + d.idx + "_dragger_horizontal," + sb + ">a"), mCSB_container = $("#mCSB_" + d.idx + "_container"); if (o.advanced.releaseDraggableSelectors) { sel.add($(o.advanced.releaseDraggableSelectors)) } if (d.bindEvents) { $(document).unbind("." + namespace); sel.each(function () { $(this).unbind("." + namespace) }); clearTimeout($this[0]._focusTimeout); _delete($this[0], "_focusTimeout"); clearTimeout(d.sequential.step); _delete(d.sequential, "step"); clearTimeout(mCSB_container[0].onCompleteTimeout); _delete(mCSB_container[0], "onCompleteTimeout"); d.bindEvents = false } }, _scrollbarVisibility = function (disabled) { var $this = $(this), d = $this.data(pluginPfx), o = d.opt, contentWrapper = $("#mCSB_" + d.idx + "_container_wrapper"), content = contentWrapper.length ? contentWrapper : $("#mCSB_" + d.idx + "_container"), scrollbar = [$("#mCSB_" + d.idx + "_scrollbar_vertical"), $("#mCSB_" + d.idx + "_scrollbar_horizontal")], mCSB_dragger = [scrollbar[0].find(".mCSB_dragger"), scrollbar[1].find(".mCSB_dragger")]; if (o.axis !== "x") { if (d.overflowed[0] && !disabled) { scrollbar[0].add(mCSB_dragger[0]).add(scrollbar[0].children("a")).css("display", "block"); content.removeClass(classes[8] + " " + classes[10]) } else { if (o.alwaysShowScrollbar) { if (o.alwaysShowScrollbar !== 2) { mCSB_dragger[0].css("display", "none") } content.removeClass(classes[10]) } else { scrollbar[0].css("display", "none"); content.addClass(classes[10]) } content.addClass(classes[8]) } } if (o.axis !== "y") { if (d.overflowed[1] && !disabled) { scrollbar[1].add(mCSB_dragger[1]).add(scrollbar[1].children("a")).css("display", "block"); content.removeClass(classes[9] + " " + classes[11]) } else { if (o.alwaysShowScrollbar) { if (o.alwaysShowScrollbar !== 2) { mCSB_dragger[1].css("display", "none") } content.removeClass(classes[11]) } else { scrollbar[1].css("display", "none"); content.addClass(classes[11]) } content.addClass(classes[9]) } } if (!d.overflowed[0] && !d.overflowed[1]) { $this.addClass(classes[5]) } else { $this.removeClass(classes[5]) } }, _coordinates = function (e) { var t = e.type; switch (t) { case "pointerdown": case "MSPointerDown": case "pointermove": case "MSPointerMove": case "pointerup": case "MSPointerUp": return e.target.ownerDocument !== document ? [e.originalEvent.screenY, e.originalEvent.screenX, false] : [e.originalEvent.pageY, e.originalEvent.pageX, false]; break; case "touchstart": case "touchmove": case "touchend": var touch = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0], touches = e.originalEvent.touches.length || e.originalEvent.changedTouches.length; return e.target.ownerDocument !== document ? [touch.screenY, touch.screenX, touches > 1] : [touch.pageY, touch.pageX, touches > 1]; break; default: return [e.pageY, e.pageX, false] } }, _draggable = function () { var $this = $(this), d = $this.data(pluginPfx), o = d.opt, namespace = pluginPfx + "_" + d.idx, draggerId = ["mCSB_" + d.idx + "_dragger_vertical", "mCSB_" + d.idx + "_dragger_horizontal"], mCSB_container = $("#mCSB_" + d.idx + "_container"), mCSB_dragger = $("#" + draggerId[0] + ",#" + draggerId[1]), draggable, dragY, dragX, rds = o.advanced.releaseDraggableSelectors ? mCSB_dragger.add($(o.advanced.releaseDraggableSelectors)) : mCSB_dragger; mCSB_dragger.bind("mousedown." + namespace + " touchstart." + namespace + " pointerdown." + namespace + " MSPointerDown." + namespace, function (e) { e.stopImmediatePropagation(); e.preventDefault(); if (!_mouseBtnLeft(e)) { return } touchActive = true; if (oldIE) { document.onselectstart = function () { return false } } _iframe(false); _stop($this); draggable = $(this); var offset = draggable.offset(), y = _coordinates(e)[0] - offset.top, x = _coordinates(e)[1] - offset.left, h = draggable.height() + offset.top, w = draggable.width() + offset.left; if (y < h && y > 0 && x < w && x > 0) { dragY = y; dragX = x } _onDragClasses(draggable, "active", o.autoExpandScrollbar) }).bind("touchmove." + namespace, function (e) { e.stopImmediatePropagation(); e.preventDefault(); var offset = draggable.offset(), y = _coordinates(e)[0] - offset.top, x = _coordinates(e)[1] - offset.left; _drag(dragY, dragX, y, x) }); $(document).bind("mousemove." + namespace + " pointermove." + namespace + " MSPointerMove." + namespace, function (e) { if (draggable) { var offset = draggable.offset(), y = _coordinates(e)[0] - offset.top, x = _coordinates(e)[1] - offset.left; if (dragY === y) { return } _drag(dragY, dragX, y, x) } }).add(rds).bind("mouseup." + namespace + " touchend." + namespace + " pointerup." + namespace + " MSPointerUp." + namespace, function (e) { if (draggable) { _onDragClasses(draggable, "active", o.autoExpandScrollbar); draggable = null } touchActive = false; if (oldIE) { document.onselectstart = null } _iframe(true); }); function _iframe(evt) { var el = mCSB_container.find("iframe"); if (!el.length) { return } var val = !evt ? "none" : "auto"; el.css("pointer-events", val); } function _drag(dragY, dragX, y, x) { mCSB_container[0].idleTimer = o.scrollInertia < 233 ? 250 : 0; if (draggable.attr("id") === draggerId[1]) { var dir = "x", to = ((draggable[0].offsetLeft - dragX) + x) * d.scrollRatio.x } else { var dir = "y", to = ((draggable[0].offsetTop - dragY) + y) * d.scrollRatio.y } _scrollTo($this, to.toString(), { dir: dir, drag: true }) } }, _contentDraggable = function () { var $this = $(this), d = $this.data(pluginPfx), o = d.opt, namespace = pluginPfx + "_" + d.idx, mCustomScrollBox = $("#mCSB_" + d.idx), mCSB_container = $("#mCSB_" + d.idx + "_container"), mCSB_dragger = [$("#mCSB_" + d.idx + "_dragger_vertical"), $("#mCSB_" + d.idx + "_dragger_horizontal")], dragY, dragX, touchStartY, touchStartX, touchMoveY = [], touchMoveX = [], startTime, runningTime, endTime, distance, speed, amount, durA = 0, durB, overwrite = o.axis === "yx" ? "none" : "all", touchIntent = [], touchDrag, docDrag, iframe = mCSB_container.find("iframe"), events = ["touchstart." + namespace + " pointerdown." + namespace + " MSPointerDown." + namespace, "touchmove." + namespace + " pointermove." + namespace + " MSPointerMove." + namespace, "touchend." + namespace + " pointerup." + namespace + " MSPointerUp." + namespace]; mCSB_container.bind(events[0], function (e) { _onTouchstart(e) }).bind(events[1], function (e) { _onTouchmove(e) }); mCustomScrollBox.bind(events[0], function (e) { _onTouchstart2(e) }).bind(events[2], function (e) { _onTouchend(e) }); if (iframe.length) { iframe.each(function () { $(this).load(function () { if (_canAccessIFrame(this)) { $(this.contentDocument || this.contentWindow.document).bind(events[0], function (e) { _onTouchstart(e); _onTouchstart2(e) }).bind(events[1], function (e) { _onTouchmove(e) }).bind(events[2], function (e) { _onTouchend(e) }) } }) }) } function _onTouchstart(e) { if (!_pointerTouch(e) || touchActive || _coordinates(e)[2]) { touchable = 0; return } touchable = 1; touchDrag = 0; docDrag = 0; $this.removeClass("mCS_touch_action"); var offset = mCSB_container.offset(); dragY = _coordinates(e)[0] - offset.top; dragX = _coordinates(e)[1] - offset.left; touchIntent = [_coordinates(e)[0], _coordinates(e)[1]] } function _onTouchmove(e) { if (!_pointerTouch(e) || touchActive || _coordinates(e)[2]) { return } e.stopImmediatePropagation(); if (docDrag && !touchDrag) { return } runningTime = _getTime(); var offset = mCustomScrollBox.offset(), y = _coordinates(e)[0] - offset.top, x = _coordinates(e)[1] - offset.left, easing = "mcsLinearOut"; touchMoveY.push(y); touchMoveX.push(x); touchIntent[2] = Math.abs(_coordinates(e)[0] - touchIntent[0]); touchIntent[3] = Math.abs(_coordinates(e)[1] - touchIntent[1]); if (d.overflowed[0]) { var limit = mCSB_dragger[0].parent().height() - mCSB_dragger[0].height(), prevent = ((dragY - y) > 0 && (y - dragY) > -(limit * d.scrollRatio.y) && (touchIntent[3] * 2 < touchIntent[2] || o.axis === "yx")) } if (d.overflowed[1]) { var limitX = mCSB_dragger[1].parent().width() - mCSB_dragger[1].width(), preventX = ((dragX - x) > 0 && (x - dragX) > -(limitX * d.scrollRatio.x) && (touchIntent[2] * 2 < touchIntent[3] || o.axis === "yx")) } if (prevent || preventX) { e.preventDefault(); touchDrag = 1 } else { docDrag = 1; $this.addClass("mCS_touch_action") } amount = o.axis === "yx" ? [(dragY - y), (dragX - x)] : o.axis === "x" ? [null, (dragX - x)] : [(dragY - y), null]; mCSB_container[0].idleTimer = 250; if (d.overflowed[0]) { _drag(amount[0], durA, easing, "y", "all", true) } if (d.overflowed[1]) { _drag(amount[1], durA, easing, "x", overwrite, true) } } function _onTouchstart2(e) { if (!_pointerTouch(e) || touchActive || _coordinates(e)[2]) { touchable = 0; return } touchable = 1; e.stopImmediatePropagation(); _stop($this); startTime = _getTime(); var offset = mCustomScrollBox.offset(); touchStartY = _coordinates(e)[0] - offset.top; touchStartX = _coordinates(e)[1] - offset.left; touchMoveY = []; touchMoveX = [] } function _onTouchend(e) { if (!_pointerTouch(e) || touchActive || _coordinates(e)[2]) { return } e.stopImmediatePropagation(); touchDrag = 0; docDrag = 0; endTime = _getTime(); var offset = mCustomScrollBox.offset(), y = _coordinates(e)[0] - offset.top, x = _coordinates(e)[1] - offset.left; if ((endTime - runningTime) > 30) { return } speed = 1000 / (endTime - startTime); var easing = "mcsEaseOut", slow = speed < 2.5, diff = slow ? [touchMoveY[touchMoveY.length - 2], touchMoveX[touchMoveX.length - 2]] : [0, 0]; distance = slow ? [(y - diff[0]), (x - diff[1])] : [y - touchStartY, x - touchStartX]; var absDistance = [Math.abs(distance[0]), Math.abs(distance[1])]; speed = slow ? [Math.abs(distance[0] / 4), Math.abs(distance[1] / 4)] : [speed, speed]; var a = [Math.abs(mCSB_container[0].offsetTop) - (distance[0] * _m((absDistance[0] / speed[0]), speed[0])), Math.abs(mCSB_container[0].offsetLeft) - (distance[1] * _m((absDistance[1] / speed[1]), speed[1]))]; amount = o.axis === "yx" ? [a[0], a[1]] : o.axis === "x" ? [null, a[1]] : [a[0], null]; durB = [(absDistance[0] * 4) + o.scrollInertia, (absDistance[1] * 4) + o.scrollInertia]; var md = parseInt(o.contentTouchScroll) || 0; amount[0] = absDistance[0] > md ? amount[0] : 0; amount[1] = absDistance[1] > md ? amount[1] : 0; if (d.overflowed[0]) { _drag(amount[0], durB[0], easing, "y", overwrite, false) } if (d.overflowed[1]) { _drag(amount[1], durB[1], easing, "x", overwrite, false) } } function _m(ds, s) { var r = [s * 1.5, s * 2, s / 1.5, s / 2]; if (ds > 90) { return s > 4 ? r[0] : r[3] } else if (ds > 60) { return s > 3 ? r[3] : r[2] } else if (ds > 30) { return s > 8 ? r[1] : s > 6 ? r[0] : s > 4 ? s : r[2] } else { return s > 8 ? s : r[3] } } function _drag(amount, dur, easing, dir, overwrite, drag) { if (!amount) { return } _scrollTo($this, amount.toString(), { dur: dur, scrollEasing: easing, dir: dir, overwrite: overwrite, drag: drag }) } }, _selectable = function () { var $this = $(this), d = $this.data(pluginPfx), o = d.opt, seq = d.sequential, namespace = pluginPfx + "_" + d.idx, mCSB_container = $("#mCSB_" + d.idx + "_container"), wrapper = mCSB_container.parent(), action; mCSB_container.bind("mousedown." + namespace, function (e) { if (touchable) { return } if (!action) { action = 1; touchActive = true } }).add(document).bind("mousemove." + namespace, function (e) { if (!touchable && action && _sel()) { var offset = mCSB_container.offset(), y = _coordinates(e)[0] - offset.top + mCSB_container[0].offsetTop, x = _coordinates(e)[1] - offset.left + mCSB_container[0].offsetLeft; if (y > 0 && y < wrapper.height() && x > 0 && x < wrapper.width()) { if (seq.step) { _seq("off", null, "stepped") } } else { if (o.axis !== "x" && d.overflowed[0]) { if (y < 0) { _seq("on", 38) } else if (y > wrapper.height()) { _seq("on", 40) } } if (o.axis !== "y" && d.overflowed[1]) { if (x < 0) { _seq("on", 37) } else if (x > wrapper.width()) { _seq("on", 39) } } } } }).bind("mouseup." + namespace, function (e) { if (touchable) { return } if (action) { action = 0; _seq("off", null) } touchActive = false }); function _sel() { return window.getSelection ? window.getSelection().toString() : document.selection && document.selection.type != "Control" ? document.selection.createRange().text : 0 } function _seq(a, c, s) { seq.type = s && action ? "stepped" : "stepless"; seq.scrollAmount = 10; _sequentialScroll($this, a, c, "mcsLinearOut", s ? 60 : null) } }, _mousewheel = function () { if (!$(this).data(pluginPfx)) { return } var $this = $(this), d = $this.data(pluginPfx), o = d.opt, namespace = pluginPfx + "_" + d.idx, mCustomScrollBox = $("#mCSB_" + d.idx), mCSB_dragger = [$("#mCSB_" + d.idx + "_dragger_vertical"), $("#mCSB_" + d.idx + "_dragger_horizontal")], iframe = $("#mCSB_" + d.idx + "_container").find("iframe"); if (iframe.length) { iframe.each(function () { $(this).load(function () { if (_canAccessIFrame(this)) { $(this.contentDocument || this.contentWindow.document).bind("mousewheel." + namespace, function (e, delta) { _onMousewheel(e, delta) }) } }) }) } mCustomScrollBox.bind("mousewheel." + namespace, function (e, delta) { _onMousewheel(e, delta) }); function _onMousewheel(e, delta) { _stop($this); if (_disableMousewheel($this, e.target)) { return } var deltaFactor = o.mouseWheel.deltaFactor !== "auto" ? parseInt(o.mouseWheel.deltaFactor) : (oldIE && e.deltaFactor < 100) ? 100 : e.deltaFactor || 100; if (o.axis === "x" || o.mouseWheel.axis === "x") { var dir = "x", px = [Math.round(deltaFactor * d.scrollRatio.x), parseInt(o.mouseWheel.scrollAmount)], amount = o.mouseWheel.scrollAmount !== "auto" ? px[1] : px[0] >= mCustomScrollBox.width() ? mCustomScrollBox.width() * 0.9 : px[0], contentPos = Math.abs($("#mCSB_" + d.idx + "_container")[0].offsetLeft), draggerPos = mCSB_dragger[1][0].offsetLeft, limit = mCSB_dragger[1].parent().width() - mCSB_dragger[1].width(), dlt = e.deltaX || e.deltaY || delta } else { var dir = "y", px = [Math.round(deltaFactor * d.scrollRatio.y), parseInt(o.mouseWheel.scrollAmount)], amount = o.mouseWheel.scrollAmount !== "auto" ? px[1] : px[0] >= mCustomScrollBox.height() ? mCustomScrollBox.height() * 0.9 : px[0], contentPos = Math.abs($("#mCSB_" + d.idx + "_container")[0].offsetTop), draggerPos = mCSB_dragger[0][0].offsetTop, limit = mCSB_dragger[0].parent().height() - mCSB_dragger[0].height(), dlt = e.deltaY || delta } if ((dir === "y" && !d.overflowed[0]) || (dir === "x" && !d.overflowed[1])) { return } if (o.mouseWheel.invert || e.webkitDirectionInvertedFromDevice) { dlt = -dlt } if (o.mouseWheel.normalizeDelta) { dlt = dlt < 0 ? -1 : 1 } if ((dlt > 0 && draggerPos !== 0) || (dlt < 0 && draggerPos !== limit) || o.mouseWheel.preventDefault) { e.stopImmediatePropagation(); e.preventDefault() } _scrollTo($this, (contentPos - (dlt * amount)).toString(), { dir: dir }) } }, _canAccessIFrame = function (iframe) { var html = null; try { var doc = iframe.contentDocument || iframe.contentWindow.document; html = doc.body.innerHTML } catch (err) { } return (html !== null) }, _disableMousewheel = function (el, target) { var tag = target.nodeName.toLowerCase(), tags = el.data(pluginPfx).opt.mouseWheel.disableOver, focusTags = ["select", "textarea"]; return $.inArray(tag, tags) > -1 && !($.inArray(tag, focusTags) > -1 && !$(target).is(":focus")) }, _draggerRail = function () { var $this = $(this), d = $this.data(pluginPfx), namespace = pluginPfx + "_" + d.idx, mCSB_container = $("#mCSB_" + d.idx + "_container"), wrapper = mCSB_container.parent(), mCSB_draggerContainer = $(".mCSB_" + d.idx + "_scrollbar ." + classes[12]); mCSB_draggerContainer.bind("touchstart." + namespace + " pointerdown." + namespace + " MSPointerDown." + namespace, function (e) { touchActive = true }).bind("touchend." + namespace + " pointerup." + namespace + " MSPointerUp." + namespace, function (e) { touchActive = false }).bind("click." + namespace, function (e) { if ($(e.target).hasClass(classes[12]) || $(e.target).hasClass("mCSB_draggerRail")) { _stop($this); var el = $(this), mCSB_dragger = el.find(".mCSB_dragger"); if (el.parent(".mCSB_scrollTools_horizontal").length > 0) { if (!d.overflowed[1]) { return } var dir = "x", clickDir = e.pageX > mCSB_dragger.offset().left ? -1 : 1, to = Math.abs(mCSB_container[0].offsetLeft) - (clickDir * (wrapper.width() * 0.9)) } else { if (!d.overflowed[0]) { return } var dir = "y", clickDir = e.pageY > mCSB_dragger.offset().top ? -1 : 1, to = Math.abs(mCSB_container[0].offsetTop) - (clickDir * (wrapper.height() * 0.9)) } _scrollTo($this, to.toString(), { dir: dir, scrollEasing: "mcsEaseInOut" }) } }) }, _focus = function () { var $this = $(this), d = $this.data(pluginPfx), o = d.opt, namespace = pluginPfx + "_" + d.idx, mCSB_container = $("#mCSB_" + d.idx + "_container"), wrapper = mCSB_container.parent(); mCSB_container.bind("focusin." + namespace, function (e) { var el = $(document.activeElement), nested = mCSB_container.find(".mCustomScrollBox").length, dur = 0; if (!el.is(o.advanced.autoScrollOnFocus)) { return } _stop($this); clearTimeout($this[0]._focusTimeout); $this[0]._focusTimer = nested ? (dur + 17) * nested : 0; $this[0]._focusTimeout = setTimeout(function () { var to = [_childPos(el)[0], _childPos(el)[1]], contentPos = [mCSB_container[0].offsetTop, mCSB_container[0].offsetLeft], isVisible = [(contentPos[0] + to[0] >= 0 && contentPos[0] + to[0] < wrapper.height() - el.outerHeight(false)), (contentPos[1] + to[1] >= 0 && contentPos[0] + to[1] < wrapper.width() - el.outerWidth(false))], overwrite = (o.axis === "yx" && !isVisible[0] && !isVisible[1]) ? "none" : "all"; if (o.axis !== "x" && !isVisible[0]) { _scrollTo($this, to[0].toString(), { dir: "y", scrollEasing: "mcsEaseInOut", overwrite: overwrite, dur: dur }) } if (o.axis !== "y" && !isVisible[1]) { _scrollTo($this, to[1].toString(), { dir: "x", scrollEasing: "mcsEaseInOut", overwrite: overwrite, dur: dur }) } }, $this[0]._focusTimer) }) }, _wrapperScroll = function () { var $this = $(this), d = $this.data(pluginPfx), namespace = pluginPfx + "_" + d.idx, wrapper = $("#mCSB_" + d.idx + "_container").parent(); wrapper.bind("scroll." + namespace, function (e) { if (wrapper.scrollTop() !== 0 || wrapper.scrollLeft() !== 0) { $(".mCSB_" + d.idx + "_scrollbar").css("visibility", "hidden"); } }) }, _buttons = function () { var $this = $(this), d = $this.data(pluginPfx), o = d.opt, seq = d.sequential, namespace = pluginPfx + "_" + d.idx, sel = ".mCSB_" + d.idx + "_scrollbar", btn = $(sel + ">a"); btn.bind("mousedown." + namespace + " touchstart." + namespace + " pointerdown." + namespace + " MSPointerDown." + namespace + " mouseup." + namespace + " touchend." + namespace + " pointerup." + namespace + " MSPointerUp." + namespace + " mouseout." + namespace + " pointerout." + namespace + " MSPointerOut." + namespace + " click." + namespace, function (e) { e.preventDefault(); if (!_mouseBtnLeft(e)) { return } var btnClass = $(this).attr("class"); seq.type = o.scrollButtons.scrollType; switch (e.type) { case "mousedown": case "touchstart": case "pointerdown": case "MSPointerDown": if (seq.type === "stepped") { return } touchActive = true; d.tweenRunning = false; _seq("on", btnClass); break; case "mouseup": case "touchend": case "pointerup": case "MSPointerUp": case "mouseout": case "pointerout": case "MSPointerOut": if (seq.type === "stepped") { return } touchActive = false; if (seq.dir) { _seq("off", btnClass) } break; case "click": if (seq.type !== "stepped" || d.tweenRunning) { return } _seq("on", btnClass); break } function _seq(a, c) { seq.scrollAmount = o.snapAmount || o.scrollButtons.scrollAmount; _sequentialScroll($this, a, c) } }) }, _keyboard = function () { var $this = $(this), d = $this.data(pluginPfx), o = d.opt, seq = d.sequential, namespace = pluginPfx + "_" + d.idx, mCustomScrollBox = $("#mCSB_" + d.idx), mCSB_container = $("#mCSB_" + d.idx + "_container"), wrapper = mCSB_container.parent(), editables = "input,textarea,select,datalist,keygen,[contenteditable='true']", iframe = mCSB_container.find("iframe"), events = ["blur." + namespace + " keydown." + namespace + " keyup." + namespace]; if (iframe.length) { iframe.each(function () { $(this).load(function () { if (_canAccessIFrame(this)) { $(this.contentDocument || this.contentWindow.document).bind(events[0], function (e) { _onKeyboard(e) }) } }) }) } mCustomScrollBox.attr("tabindex", "0").bind(events[0], function (e) { _onKeyboard(e) }); function _onKeyboard(e) { switch (e.type) { case "blur": if (d.tweenRunning && seq.dir) { _seq("off", null) } break; case "keydown": case "keyup": var code = e.keyCode ? e.keyCode : e.which, action = "on"; if ((o.axis !== "x" && (code === 38 || code === 40)) || (o.axis !== "y" && (code === 37 || code === 39))) { if (((code === 38 || code === 40) && !d.overflowed[0]) || ((code === 37 || code === 39) && !d.overflowed[1])) { return } if (e.type === "keyup") { action = "off" } if (!$(document.activeElement).is(editables)) { e.preventDefault(); e.stopImmediatePropagation(); _seq(action, code) } } else if (code === 33 || code === 34) { if (d.overflowed[0] || d.overflowed[1]) { e.preventDefault(); e.stopImmediatePropagation() } if (e.type === "keyup") { _stop($this); var keyboardDir = code === 34 ? -1 : 1; if (o.axis === "x" || (o.axis === "yx" && d.overflowed[1] && !d.overflowed[0])) { var dir = "x", to = Math.abs(mCSB_container[0].offsetLeft) - (keyboardDir * (wrapper.width() * 0.9)) } else { var dir = "y", to = Math.abs(mCSB_container[0].offsetTop) - (keyboardDir * (wrapper.height() * 0.9)) } _scrollTo($this, to.toString(), { dir: dir, scrollEasing: "mcsEaseInOut" }) } } else if (code === 35 || code === 36) { if (!$(document.activeElement).is(editables)) { if (d.overflowed[0] || d.overflowed[1]) { e.preventDefault(); e.stopImmediatePropagation() } if (e.type === "keyup") { if (o.axis === "x" || (o.axis === "yx" && d.overflowed[1] && !d.overflowed[0])) { var dir = "x", to = code === 35 ? Math.abs(wrapper.width() - mCSB_container.outerWidth(false)) : 0 } else { var dir = "y", to = code === 35 ? Math.abs(wrapper.height() - mCSB_container.outerHeight(false)) : 0 } _scrollTo($this, to.toString(), { dir: dir, scrollEasing: "mcsEaseInOut" }) } } } break } function _seq(a, c) { seq.type = o.keyboard.scrollType; seq.scrollAmount = o.snapAmount || o.keyboard.scrollAmount; if (seq.type === "stepped" && d.tweenRunning) { return } _sequentialScroll($this, a, c) } } }, _sequentialScroll = function (el, action, trigger, e, s) { var d = el.data(pluginPfx), o = d.opt, seq = d.sequential, mCSB_container = $("#mCSB_" + d.idx + "_container"), once = seq.type === "stepped" ? true : false, steplessSpeed = o.scrollInertia < 26 ? 26 : o.scrollInertia, steppedSpeed = o.scrollInertia < 1 ? 17 : o.scrollInertia; switch (action) { case "on": seq.dir = [(trigger === classes[16] || trigger === classes[15] || trigger === 39 || trigger === 37 ? "x" : "y"), (trigger === classes[13] || trigger === classes[15] || trigger === 38 || trigger === 37 ? -1 : 1)]; _stop(el); if (_isNumeric(trigger) && seq.type === "stepped") { return } _on(once); break; case "off": _off(); if (once || (d.tweenRunning && seq.dir)) { _on(true) } break } function _on(once) { var c = seq.type !== "stepped", t = s ? s : !once ? 1000 / 60 : c ? steplessSpeed / 1.5 : steppedSpeed, m = !once ? 2.5 : c ? 7.5 : 40, contentPos = [Math.abs(mCSB_container[0].offsetTop), Math.abs(mCSB_container[0].offsetLeft)], ratio = [d.scrollRatio.y > 10 ? 10 : d.scrollRatio.y, d.scrollRatio.x > 10 ? 10 : d.scrollRatio.x], amount = seq.dir[0] === "x" ? contentPos[1] + (seq.dir[1] * (ratio[1] * m)) : contentPos[0] + (seq.dir[1] * (ratio[0] * m)), px = seq.dir[0] === "x" ? contentPos[1] + (seq.dir[1] * parseInt(seq.scrollAmount)) : contentPos[0] + (seq.dir[1] * parseInt(seq.scrollAmount)), to = seq.scrollAmount !== "auto" ? px : amount, easing = e ? e : !once ? "mcsLinear" : c ? "mcsLinearOut" : "mcsEaseInOut", onComplete = !once ? false : true; if (once && t < 17) { to = seq.dir[0] === "x" ? contentPos[1] : contentPos[0] } _scrollTo(el, to.toString(), { dir: seq.dir[0], scrollEasing: easing, dur: t, onComplete: onComplete }); if (once) { seq.dir = false; return } clearTimeout(seq.step); seq.step = setTimeout(function () { _on() }, t) } function _off() { clearTimeout(seq.step); _delete(seq, "step"); _stop(el) } }, _arr = function (val) { var o = $(this).data(pluginPfx).opt, vals = []; if (typeof val === "function") { val = val() } if (!(val instanceof Array)) { vals[0] = val.y ? val.y : val.x || o.axis === "x" ? null : val; vals[1] = val.x ? val.x : val.y || o.axis === "y" ? null : val } else { vals = val.length > 1 ? [val[0], val[1]] : o.axis === "x" ? [null, val[0]] : [val[0], null] } if (typeof vals[0] === "function") { vals[0] = vals[0]() } if (typeof vals[1] === "function") { vals[1] = vals[1]() } return vals }, _to = function (val, dir) { if (val == null || typeof val == "undefined") { return } var $this = $(this), d = $this.data(pluginPfx), o = d.opt, mCSB_container = $("#mCSB_" + d.idx + "_container"), wrapper = mCSB_container.parent(), t = typeof val; if (!dir) { dir = o.axis === "x" ? "x" : "y" } var contentLength = dir === "x" ? mCSB_container.outerWidth(false) : mCSB_container.outerHeight(false), contentPos = dir === "x" ? mCSB_container[0].offsetLeft : mCSB_container[0].offsetTop, cssProp = dir === "x" ? "left" : "top"; switch (t) { case "function": return val(); break; case "object": var obj = val.jquery ? val : $(val); if (!obj.length) { return } return dir === "x" ? _childPos(obj)[1] : _childPos(obj)[0]; break; case "string": case "number": if (_isNumeric(val)) { return Math.abs(val) } else if (val.indexOf("%") !== -1) { return Math.abs(contentLength * parseInt(val) / 100) } else if (val.indexOf("-=") !== -1) { return Math.abs(contentPos - parseInt(val.split("-=")[1])) } else if (val.indexOf("+=") !== -1) { var p = (contentPos + parseInt(val.split("+=")[1])); return p >= 0 ? 0 : Math.abs(p) } else if (val.indexOf("px") !== -1 && _isNumeric(val.split("px")[0])) { return Math.abs(val.split("px")[0]) } else { if (val === "top" || val === "left") { return 0 } else if (val === "bottom") { return Math.abs(wrapper.height() - mCSB_container.outerHeight(false)) } else if (val === "right") { return Math.abs(wrapper.width() - mCSB_container.outerWidth(false)) } else if (val === "first" || val === "last") { var obj = mCSB_container.find(":" + val); return dir === "x" ? _childPos(obj)[1] : _childPos(obj)[0] } else { if ($(val).length) { return dir === "x" ? _childPos($(val))[1] : _childPos($(val))[0] } else { mCSB_container.css(cssProp, val); methods.update.call(null, $this[0]); return } } } break } }, _autoUpdate = function (rem) { var $this = $(this), d = $this.data(pluginPfx), o = d.opt, mCSB_container = $("#mCSB_" + d.idx + "_container"); if (rem) { clearTimeout(mCSB_container[0].autoUpdate); _delete(mCSB_container[0], "autoUpdate"); return } var wrapper = mCSB_container.parent(), scrollbar = [$("#mCSB_" + d.idx + "_scrollbar_vertical"), $("#mCSB_" + d.idx + "_scrollbar_horizontal")], scrollbarSize = function () { return [scrollbar[0].is(":visible") ? scrollbar[0].outerHeight(true) : 0, scrollbar[1].is(":visible") ? scrollbar[1].outerWidth(true) : 0] }, oldSelSize = sizesSum(), newSelSize, os = [mCSB_container.outerHeight(false), mCSB_container.outerWidth(false), wrapper.height(), wrapper.width(), scrollbarSize()[0], scrollbarSize()[1]], ns, oldImgsLen = imgSum(), newImgsLen; upd(); function upd() { clearTimeout(mCSB_container[0].autoUpdate); if ($this.parents("html").length === 0) { $this = null; return } mCSB_container[0].autoUpdate = setTimeout(function () { if (o.advanced.updateOnSelectorChange) { newSelSize = sizesSum(); if (newSelSize !== oldSelSize) { doUpd(3); oldSelSize = newSelSize; return } } if (o.advanced.updateOnContentResize) { ns = [mCSB_container.outerHeight(false), mCSB_container.outerWidth(false), wrapper.height(), wrapper.width(), scrollbarSize()[0], scrollbarSize()[1]]; if (ns[0] !== os[0] || ns[1] !== os[1] || ns[2] !== os[2] || ns[3] !== os[3] || ns[4] !== os[4] || ns[5] !== os[5]) { doUpd(ns[0] !== os[0] || ns[1] !== os[1]); os = ns } } if (o.advanced.updateOnImageLoad) { newImgsLen = imgSum(); if (newImgsLen !== oldImgsLen) { mCSB_container.find("img").each(function () { imgLoader(this) }); oldImgsLen = newImgsLen } } if (o.advanced.updateOnSelectorChange || o.advanced.updateOnContentResize || o.advanced.updateOnImageLoad) { upd() } }, o.advanced.autoUpdateTimeout) } function imgSum() { var total = 0; if (o.advanced.updateOnImageLoad) { total = mCSB_container.find("img").length } return total } function imgLoader(el) { if ($(el).hasClass(classes[2])) { doUpd(); return } var img = new Image(); function createDelegate(contextObject, delegateMethod) { return function () { return delegateMethod.apply(contextObject, arguments) } } function imgOnLoad() { this.onload = null; $(el).addClass(classes[2]); doUpd(2) } img.onload = createDelegate(img, imgOnLoad); img.src = el.src } function sizesSum() { if (o.advanced.updateOnSelectorChange === true) { o.advanced.updateOnSelectorChange = "*" } var total = 0, sel = mCSB_container.find(o.advanced.updateOnSelectorChange); if (o.advanced.updateOnSelectorChange && sel.length > 0) { sel.each(function () { total += $(this).height() + $(this).width() }) } return total } function doUpd(cb) { clearTimeout(mCSB_container[0].autoUpdate); methods.update.call(null, $this[0], cb) } }, _snapAmount = function (to, amount, offset) { return (Math.round(to / amount) * amount - offset) }, _stop = function (el) { var d = el.data(pluginPfx), sel = $("#mCSB_" + d.idx + "_container,#mCSB_" + d.idx + "_container_wrapper,#mCSB_" + d.idx + "_dragger_vertical,#mCSB_" + d.idx + "_dragger_horizontal"); sel.each(function () { _stopTween.call(this) }) }, _scrollTo = function (el, to, options) { var d = el.data(pluginPfx), o = d.opt, defaults = { trigger: "internal", dir: "y", scrollEasing: "mcsEaseOut", drag: false, dur: o.scrollInertia, overwrite: "all", callbacks: true, onStart: true, onUpdate: true, onComplete: true }, options = $.extend(defaults, options), dur = [options.dur, (options.drag ? 0 : options.dur)], mCustomScrollBox = $("#mCSB_" + d.idx), mCSB_container = $("#mCSB_" + d.idx + "_container"), wrapper = mCSB_container.parent(), totalScrollOffsets = o.callbacks.onTotalScrollOffset ? _arr.call(el, o.callbacks.onTotalScrollOffset) : [0, 0], totalScrollBackOffsets = o.callbacks.onTotalScrollBackOffset ? _arr.call(el, o.callbacks.onTotalScrollBackOffset) : [0, 0]; d.trigger = options.trigger; if (wrapper.scrollTop() !== 0 || wrapper.scrollLeft() !== 0) { $(".mCSB_" + d.idx + "_scrollbar").css("visibility", "visible"); wrapper.scrollTop(0).scrollLeft(0) } if (to === "_resetY" && !d.contentReset.y) { if (_cb("onOverflowYNone")) { o.callbacks.onOverflowYNone.call(el[0]) } d.contentReset.y = 1 } if (to === "_resetX" && !d.contentReset.x) { if (_cb("onOverflowXNone")) { o.callbacks.onOverflowXNone.call(el[0]) } d.contentReset.x = 1 } if (to === "_resetY" || to === "_resetX") { return } if ((d.contentReset.y || !el[0].mcs) && d.overflowed[0]) { if (_cb("onOverflowY")) { o.callbacks.onOverflowY.call(el[0]) } d.contentReset.x = null } if ((d.contentReset.x || !el[0].mcs) && d.overflowed[1]) { if (_cb("onOverflowX")) { o.callbacks.onOverflowX.call(el[0]) } d.contentReset.x = null } if (o.snapAmount) { to = _snapAmount(to, o.snapAmount, o.snapOffset) } switch (options.dir) { case "x": var mCSB_dragger = $("#mCSB_" + d.idx + "_dragger_horizontal"), property = "left", contentPos = mCSB_container[0].offsetLeft, limit = [mCustomScrollBox.width() - mCSB_container.outerWidth(false), mCSB_dragger.parent().width() - mCSB_dragger.width()], scrollTo = [to, to === 0 ? 0 : (to / d.scrollRatio.x)], tso = totalScrollOffsets[1], tsbo = totalScrollBackOffsets[1], totalScrollOffset = tso > 0 ? tso / d.scrollRatio.x : 0, totalScrollBackOffset = tsbo > 0 ? tsbo / d.scrollRatio.x : 0; break; case "y": var mCSB_dragger = $("#mCSB_" + d.idx + "_dragger_vertical"), property = "top", contentPos = mCSB_container[0].offsetTop, limit = [mCustomScrollBox.height() - mCSB_container.outerHeight(false), mCSB_dragger.parent().height() - mCSB_dragger.height()], scrollTo = [to, to === 0 ? 0 : (to / d.scrollRatio.y)], tso = totalScrollOffsets[0], tsbo = totalScrollBackOffsets[0], totalScrollOffset = tso > 0 ? tso / d.scrollRatio.y : 0, totalScrollBackOffset = tsbo > 0 ? tsbo / d.scrollRatio.y : 0; break } if (scrollTo[1] < 0 || (scrollTo[0] === 0 && scrollTo[1] === 0)) { scrollTo = [0, 0] } else if (scrollTo[1] >= limit[1]) { scrollTo = [limit[0], limit[1]] } else { scrollTo[0] = -scrollTo[0] } if (!el[0].mcs) { _mcs(); if (_cb("onInit")) { o.callbacks.onInit.call(el[0]) } } clearTimeout(mCSB_container[0].onCompleteTimeout); if (!d.tweenRunning && ((contentPos === 0 && scrollTo[0] >= 0) || (contentPos === limit[0] && scrollTo[0] <= limit[0]))) { return } _tweenTo(mCSB_dragger[0], property, Math.round(scrollTo[1]), dur[1], options.scrollEasing); _tweenTo(mCSB_container[0], property, Math.round(scrollTo[0]), dur[0], options.scrollEasing, options.overwrite, { onStart: function () { if (options.callbacks && options.onStart && !d.tweenRunning) { if (_cb("onScrollStart")) { _mcs(); o.callbacks.onScrollStart.call(el[0]) } d.tweenRunning = true; _onDragClasses(mCSB_dragger); d.cbOffsets = _cbOffsets() } }, onUpdate: function () { if (options.callbacks && options.onUpdate) { if (_cb("whileScrolling")) { _mcs(); o.callbacks.whileScrolling.call(el[0]) } } }, onComplete: function () { if (options.callbacks && options.onComplete) { if (o.axis === "yx") { clearTimeout(mCSB_container[0].onCompleteTimeout) } var t = mCSB_container[0].idleTimer || 0; mCSB_container[0].onCompleteTimeout = setTimeout(function () { if (_cb("onScroll")) { _mcs(); o.callbacks.onScroll.call(el[0]) } if (_cb("onTotalScroll") && scrollTo[1] >= limit[1] - totalScrollOffset && d.cbOffsets[0]) { _mcs(); o.callbacks.onTotalScroll.call(el[0]) } if (_cb("onTotalScrollBack") && scrollTo[1] <= totalScrollBackOffset && d.cbOffsets[1]) { _mcs(); o.callbacks.onTotalScrollBack.call(el[0]) } d.tweenRunning = false; mCSB_container[0].idleTimer = 0; _onDragClasses(mCSB_dragger, "hide") }, t) } } }); function _cb(cb) { return d && o.callbacks[cb] && typeof o.callbacks[cb] === "function" } function _cbOffsets() { return [o.callbacks.alwaysTriggerOffsets || contentPos >= limit[0] + tso, o.callbacks.alwaysTriggerOffsets || contentPos <= -tsbo] } function _mcs() { var cp = [mCSB_container[0].offsetTop, mCSB_container[0].offsetLeft], dp = [mCSB_dragger[0].offsetTop, mCSB_dragger[0].offsetLeft], cl = [mCSB_container.outerHeight(false), mCSB_container.outerWidth(false)], pl = [mCustomScrollBox.height(), mCustomScrollBox.width()]; el[0].mcs = { content: mCSB_container, top: cp[0], left: cp[1], draggerTop: dp[0], draggerLeft: dp[1], topPct: Math.round((100 * Math.abs(cp[0])) / (Math.abs(cl[0]) - pl[0])), leftPct: Math.round((100 * Math.abs(cp[1])) / (Math.abs(cl[1]) - pl[1])), direction: options.dir }; } }, _tweenTo = function (el, prop, to, duration, easing, overwrite, callbacks) { if (!el._mTween) { el._mTween = { top: {}, left: {} } } var callbacks = callbacks || {}, onStart = callbacks.onStart || function () { }, onUpdate = callbacks.onUpdate || function () { }, onComplete = callbacks.onComplete || function () { }, startTime = _getTime(), _delay, progress = 0, from = el.offsetTop, elStyle = el.style, _request, tobj = el._mTween[prop]; if (prop === "left") { from = el.offsetLeft } var diff = to - from; tobj.stop = 0; if (overwrite !== "none") { _cancelTween() } _startTween(); function _step() { if (tobj.stop) { return } if (!progress) { onStart.call() } progress = _getTime() - startTime; _tween(); if (progress >= tobj.time) { tobj.time = (progress > tobj.time) ? progress + _delay - (progress - tobj.time) : progress + _delay - 1; if (tobj.time < progress + 1) { tobj.time = progress + 1 } } if (tobj.time < duration) { tobj.id = _request(_step) } else { onComplete.call() } } function _tween() { if (duration > 0) { tobj.currVal = _ease(tobj.time, from, diff, duration, easing); elStyle[prop] = Math.round(tobj.currVal) + "px" } else { elStyle[prop] = to + "px" } onUpdate.call() } function _startTween() { _delay = 1000 / 60; tobj.time = progress + _delay; _request = (!window.requestAnimationFrame) ? function (f) { _tween(); return setTimeout(f, 0.01) } : window.requestAnimationFrame; tobj.id = _request(_step) } function _cancelTween() { if (tobj.id == null) { return } if (!window.requestAnimationFrame) { clearTimeout(tobj.id) } else { window.cancelAnimationFrame(tobj.id) } tobj.id = null } function _ease(t, b, c, d, type) { switch (type) { case "linear": case "mcsLinear": return c * t / d + b; break; case "mcsLinearOut": t /= d; t -= 1; return c * Math.sqrt(1 - t * t) + b; break; case "easeInOutSmooth": t /= d / 2; if (t < 1) { return c / 2 * t * t + b } t -= 1; return -c / 2 * (t * (t - 2) - 1) + b; break; case "easeInOutStrong": t /= d / 2; if (t < 1) { return c / 2 * Math.pow(2, 10 * (t - 1)) + b } t -= 1; return c / 2 * (-Math.pow(2, -10 * t) + 2) + b; break; case "easeInOut": case "mcsEaseInOut": t /= d / 2; if (t < 1) { return c / 2 * t * t * t + b } t -= 2; return c / 2 * (t * t * t + 2) + b; break; case "easeOutSmooth": t /= d; t -= 1; return -c * (t * t * t * t - 1) + b; break; case "easeOutStrong": return c * (-Math.pow(2, -10 * t / d) + 1) + b; break; case "easeOut": case "mcsEaseOut": default: var ts = (t /= d) * t, tc = ts * t; return b + c * (0.499999999999997 * tc * ts + -2.5 * ts * ts + 5.5 * tc + -6.5 * ts + 4 * t) } } }, _getTime = function () { if (window.performance && window.performance.now) { return window.performance.now() } else { if (window.performance && window.performance.webkitNow) { return window.performance.webkitNow() } else { if (Date.now) { return Date.now() } else { return new Date().getTime() } } } }, _stopTween = function () { var el = this; if (!el._mTween) { el._mTween = { top: {}, left: {} } } var props = ["top", "left"]; for (var i = 0; i < props.length; i += 1) { var prop = props[i]; if (el._mTween[prop].id) { if (!window.requestAnimationFrame) { clearTimeout(el._mTween[prop].id) } else { window.cancelAnimationFrame(el._mTween[prop].id) } el._mTween[prop].id = null; el._mTween[prop].stop = 1 } } }, _delete = function (c, m) { try { delete c[m] } catch (e) { c[m] = null } }, _mouseBtnLeft = function (e) { return !(e.which && e.which !== 1) }, _pointerTouch = function (e) { var t = e.originalEvent.pointerType; return !(t && t !== "touch" && t !== 2) }, _isNumeric = function (val) { return !isNaN(parseFloat(val)) && isFinite(val) }, _childPos = function (el) { var p = el.parents(".mCSB_container"); return [el.offset().top - p.offset().top, el.offset().left - p.offset().left] }; $.fn[pluginNS] = function (method) { if (methods[method]) { return methods[method].apply(this, Array.prototype.slice.call(arguments, 1)) } else if (typeof method === "object" || !method) { return methods.init.apply(this, arguments) } else { $.error("Method " + method + " does not exist") } }; $[pluginNS] = function (method) { if (methods[method]) { return methods[method].apply(this, Array.prototype.slice.call(arguments, 1)) } else if (typeof method === "object" || !method) { return methods.init.apply(this, arguments) } else { $.error("Method " + method + " does not exist") } }; $[pluginNS].defaults = defaults; window[pluginNS] = true; $(window).load(function () { $(defaultSelector)[pluginNS](); $.extend($.expr[":"], { mcsInView: $.expr[":"].mcsInView || function (el) { var $el = $(el), content = $el.parents(".mCSB_container"), wrapper, cPos; if (!content.length) { return } wrapper = content.parent(); cPos = [content[0].offsetTop, content[0].offsetLeft]; return cPos[0] + _childPos($el)[0] >= 0 && cPos[0] + _childPos($el)[0] < wrapper.height() - $el.outerHeight(false) && cPos[1] + _childPos($el)[1] >= 0 && cPos[1] + _childPos($el)[1] < wrapper.width() - $el.outerWidth(false) }, mcsOverflow: $.expr[":"].mcsOverflow || function (el) { var d = $(el).data(pluginPfx); if (!d) { return } return d.overflowed[0] || d.overflowed[1] } }) }) })) }));
//图片剪切
eval(function (p, a, c, k, e, d) {
    e = function (c) {
        return (c < a ? '' : e(parseInt(c / a))) + ((c = c % a) > 35 ? String.fromCharCode(c + 29) : c.toString(36))
    };
    while (c--)
        if (k[c]) p = p.replace(new RegExp('\\b' + e(c) + '\\b', 'g'), k[c]);
    return p
}('(m($){18 W=2v.4T,D=2v.4S,F=2v.4R,u=2v.4Q;m V(){C $("<4P/>")};$.N=m(T,c){18 O=$(T),1F,A=V(),1k=V(),I=V().r(V()).r(V()).r(V()),B=V().r(V()).r(V()).r(V()),E=$([]),1K,G,l,17={v:0,l:0},Q,M,1l,1g={v:0,l:0},12=0,1J="1H",2k,2j,1t,1s,S,1B,1A,2o,2n,14,1Q,a,b,j,g,f={a:0,b:0,j:0,g:0,H:0,L:0},2u=R.4O,1M=4N.4M,$p,d,i,o,w,h,2p;m 1n(x){C x+17.v-1g.v};m 1m(y){C y+17.l-1g.l};m 1b(x){C x-17.v+1g.v};m 1a(y){C y-17.l+1g.l};m 1z(3J){C 3J.4L-1g.v};m 1y(3I){C 3I.4K-1g.l};m 13(32){18 1i=32||1t,1h=32||1s;C{a:u(f.a*1i),b:u(f.b*1h),j:u(f.j*1i),g:u(f.g*1h),H:u(f.j*1i)-u(f.a*1i),L:u(f.g*1h)-u(f.b*1h)}};m 23(a,b,j,g,31){18 1i=31||1t,1h=31||1s;f={a:u(a/1i||0),b:u(b/1h||0),j:u(j/1i||0),g:u(g/1h||0)};f.H=f.j-f.a;f.L=f.g-f.b};m 1f(){9(!1F||!O.H()){C}17={v:u(O.2t().v),l:u(O.2t().l)};Q=O.2Y();M=O.3H();17.l+=(O.30()-M)>>1;17.v+=(O.2q()-Q)>>1;1B=u(c.4J/1t)||0;1A=u(c.4I/1s)||0;2o=u(F(c.4H/1t||1<<24,Q));2n=u(F(c.4G/1s||1<<24,M));9($().4F=="1.3.2"&&1J=="21"&&!2u["4E"]){17.l+=D(R.1q.2r,2u.2r);17.v+=D(R.1q.2s,2u.2s)}1g=/1H|4D/.1c(1l.q("1p"))?{v:u(1l.2t().v)-1l.2s(),l:u(1l.2t().l)-1l.2r()}:1J=="21"?{v:$(R).2s(),l:$(R).2r()}:{v:0,l:0};G=1n(0);l=1m(0);9(f.j>Q||f.g>M){1U()}};m 1V(3F){9(!1Q){C}A.q({v:1n(f.a),l:1m(f.b)}).r(1k).H(w=f.H).L(h=f.L);1k.r(I).r(E).q({v:0,l:0});I.H(D(w-I.2q()+I.2Y(),0)).L(D(h-I.30()+I.3H(),0));$(B[0]).q({v:G,l:l,H:f.a,L:M});$(B[1]).q({v:G+f.a,l:l,H:w,L:f.b});$(B[2]).q({v:G+f.j,l:l,H:Q-f.j,L:M});$(B[3]).q({v:G+f.a,l:l+f.g,H:w,L:M-f.g});w-=E.2q();h-=E.30();2O(E.3f){15 8:$(E[4]).q({v:w>>1});$(E[5]).q({v:w,l:h>>1});$(E[6]).q({v:w>>1,l:h});$(E[7]).q({l:h>>1});15 4:E.3G(1,3).q({v:w});E.3G(2,4).q({l:h})}9(3F!==Y){9($.N.2Z!=2R){$(R).U($.N.2z,$.N.2Z)}9(c.1T){$(R)[$.N.2z]($.N.2Z=2R)}}9(1j&&I.2q()-I.2Y()==2){I.q("3E",0);3x(m(){I.q("3E","4C")},0)}};m 22(3D){1f();1V(3D);a=1n(f.a);b=1m(f.b);j=1n(f.j);g=1m(f.g)};m 27(2X,2w){c.1P?2X.4B(c.1P,2w):2X.1r()};m 1d(2W){18 x=1b(1z(2W))-f.a,y=1a(1y(2W))-f.b;9(!2p){1f();2p=11;A.1G("4A",m(){2p=Y})}S="";9(c.2D){9(y<=c.1W){S="n"}X{9(y>=f.L-c.1W){S="s"}}9(x<=c.1W){S+="w"}X{9(x>=f.H-c.1W){S+="e"}}}A.q("2V",S?S+"-19":c.26?"4z":"");9(1K){1K.4y()}};m 2S(4x){$("1q").q("2V","");9(c.4w||f.H*f.L==0){27(A.r(B),m(){$(J).1r()})}$(R).U("P",2l);A.P(1d);c.2f(T,13())};m 2C(1X){9(1X.3z!=1){C Y}1f();9(S){$("1q").q("2V",S+"-19");a=1n(f[/w/.1c(S)?"j":"a"]);b=1m(f[/n/.1c(S)?"g":"b"]);$(R).P(2l).1G("1x",2S);A.U("P",1d)}X{9(c.26){2k=G+f.a-1z(1X);2j=l+f.b-1y(1X);A.U("P",1d);$(R).P(2T).1G("1x",m(){c.2f(T,13());$(R).U("P",2T);A.P(1d)})}X{O.1O(1X)}}C Y};m 1w(3C){9(14){9(3C){j=D(G,F(G+Q,a+W(g-b)*14*(j>a||-1)));g=u(D(l,F(l+M,b+W(j-a)/14*(g>b||-1))));j=u(j)}X{g=D(l,F(l+M,b+W(j-a)/14*(g>b||-1)));j=u(D(G,F(G+Q,a+W(g-b)*14*(j>a||-1))));g=u(g)}}};m 1U(){a=F(a,G+Q);b=F(b,l+M);9(W(j-a)<1B){j=a-1B*(j<a||-1);9(j<G){a=G+1B}X{9(j>G+Q){a=G+Q-1B}}}9(W(g-b)<1A){g=b-1A*(g<b||-1);9(g<l){b=l+1A}X{9(g>l+M){b=l+M-1A}}}j=D(G,F(j,G+Q));g=D(l,F(g,l+M));1w(W(j-a)<W(g-b)*14);9(W(j-a)>2o){j=a-2o*(j<a||-1);1w()}9(W(g-b)>2n){g=b-2n*(g<b||-1);1w(11)}f={a:1b(F(a,j)),j:1b(D(a,j)),b:1a(F(b,g)),g:1a(D(b,g)),H:W(j-a),L:W(g-b)};1V();c.2g(T,13())};m 2l(2U){j=/w|e|^$/.1c(S)||14?1z(2U):1n(f.j);g=/n|s|^$/.1c(S)||14?1y(2U):1m(f.g);1U();C Y};m 1v(3B,3A){j=(a=3B)+f.H;g=(b=3A)+f.L;$.2c(f,{a:1b(a),b:1a(b),j:1b(j),g:1a(g)});1V();c.2g(T,13())};m 2T(2m){a=D(G,F(2k+1z(2m),G+Q-f.H));b=D(l,F(2j+1y(2m),l+M-f.L));1v(a,b);2m.4v();C Y};m 2h(){$(R).U("P",2h);1f();j=a;g=b;1U();S="";9(!B.2y(":4u")){A.r(B).1r().2E(c.1P||0)}1Q=11;$(R).U("1x",1N).P(2l).1G("1x",2S);A.U("P",1d);c.3y(T,13())};m 1N(){$(R).U("P",2h).U("1x",1N);27(A.r(B));23(1b(a),1a(b),1b(a),1a(b));9(!(J 4t $.N)){c.2g(T,13());c.2f(T,13())}};m 2A(2i){9(2i.3z!=1||B.2y(":4s")){C Y}1f();2k=a=1z(2i);2j=b=1y(2i);$(R).P(2h).1x(1N);C Y};m 2B(){22(Y)};m 2x(){1F=11;25(c=$.2c({1S:"4r",26:11,20:"1q",2D:11,1W:10,3w:m(){},3y:m(){},2g:m(){},2f:m(){}},c));A.r(B).q({3b:""});9(c.2F){1Q=11;1f();1V();A.r(B).1r().2E(c.1P||0)}3x(m(){c.3w(T,13())},0)};18 2R=m(16){18 k=c.1T,d,t,2N=16.4q;d=!1L(k.2P)&&(16.2e||16.3t.2e)?k.2P:!1L(k.2a)&&16.3u?k.2a:!1L(k.2b)&&16.3v?k.2b:!1L(k.2Q)?k.2Q:10;9(k.2Q=="19"||(k.2b=="19"&&16.3v)||(k.2a=="19"&&16.3u)||(k.2P=="19"&&(16.2e||16.3t.2e))){2O(2N){15 37:d=-d;15 39:t=D(a,j);a=F(a,j);j=D(t+d,a);1w();1u;15 38:d=-d;15 40:t=D(b,g);b=F(b,g);g=D(t+d,b);1w(11);1u;3s:C}1U()}X{a=F(a,j);b=F(b,g);2O(2N){15 37:1v(D(a-d,G),b);1u;15 38:1v(a,D(b-d,l));1u;15 39:1v(a+F(d,Q-1b(j)),b);1u;15 40:1v(a,b+F(d,M-1a(g)));1u;3s:C}}C Y};m 1R(3r,2M){3p(18 2d 4p 2M){9(c[2d]!==1Y){3r.q(2M[2d],c[2d])}}};m 25(K){9(K.20){(1l=$(K.20)).2G(A.r(B))}$.2c(c,K);1f();9(K.2L!=3q){E.1o();E=$([]);i=K.2L?K.2L=="4o"?4:8:0;3g(i--){E=E.r(V())}E.29(c.1S+"-4n").q({1p:"1H",36:0,1I:12+1||1});9(!4m(E.q("H"))>=0){E.H(5).L(5)}9(o=c.2K){E.q({2K:o,2H:"3m"})}1R(E,{3n:"2J-28",3l:"2I-28",3o:"1e"})}1t=c.4l/Q||1;1s=c.4k/M||1;9(K.a!=3q){23(K.a,K.b,K.j,K.g);K.2F=!K.1r}9(K.1T){c.1T=$.2c({2b:1,2a:"19"},K.1T)}B.29(c.1S+"-4j");1k.29(c.1S+"-4i");3p(i=0;i++<4;){$(I[i-1]).29(c.1S+"-2J"+i)}1R(1k,{4h:"2I-28",4g:"1e"});1R(I,{3o:"1e",2K:"2J-H"});1R(B,{4f:"2I-28",4e:"1e"});9(o=c.3n){$(I[0]).q({2H:"3m",3k:o})}9(o=c.3l){$(I[1]).q({2H:"4d",3k:o})}A.2G(1k.r(I).r(1K)).2G(E);9(1j){9(o=(B.q("3j")||"").3i(/1e=(\\d+)/)){B.q("1e",o[1]/1Z)}9(o=(I.q("3j")||"").3i(/1e=(\\d+)/)){I.q("1e",o[1]/1Z)}}9(K.1r){27(A.r(B))}X{9(K.2F&&1F){1Q=11;A.r(B).2E(c.1P||0);22()}}14=(d=(c.4c||"").4b(/:/))[0]/d[1];O.r(B).U("1O",2A);9(c.1E||c.1D===Y){A.U("P",1d).U("1O",2C);$(3h).U("19",2B)}X{9(c.1D||c.1E===Y){9(c.2D||c.26){A.P(1d).1O(2C)}$(3h).19(2B)}9(!c.4a){O.r(B).1O(2A)}}c.1D=c.1E=1Y};J.1o=m(){25({1E:11});A.r(B).1o()};J.49=m(){C c};J.33=25;J.48=13;J.47=23;J.46=1N;J.45=22;18 1j=(/44 ([\\w.]+)/i.43(1M)||[])[1],3c=/42/i.1c(1M),3d=/41/i.1c(1M)&&!/3Z/i.1c(1M);$p=O;3g($p.3f){12=D(12,!1L($p.q("z-3e"))?$p.q("z-3e"):12);9($p.q("1p")=="21"){1J="21"}$p=$p.20(":3Y(1q)")}12=c.1I||12;9(1j){O.3X("3W","3V")}$.N.2z=1j||3d?"3U":"3T";9(3c){1K=V().q({H:"1Z%",L:"1Z%",1p:"1H",1I:12+2||2})}A.r(B).q({3b:"3a",1p:1J,3S:"3a",1I:12||"0"});A.q({1I:12+2||2});1k.r(I).q({1p:"1H",36:0});T.35||T.3R=="35"||!O.2y("3Q")?2x():O.1G("3P",2x);9(!1F&&1j&&1j>=7){T.34=T.34}};$.2w.N=m(Z){Z=Z||{};J.3O(m(){9($(J).1C("N")){9(Z.1o){$(J).1C("N").1o();$(J).3N("N")}X{$(J).1C("N").33(Z)}}X{9(!Z.1o){9(Z.1D===1Y&&Z.1E===1Y){Z.1D=11}$(J).1C("N",3M $.N(J,Z))}}});9(Z.3L){C $(J).1C("N")}C J}})(3K);', 62, 304, '|||||||||if|x1|y1|_7|||_23|y2|||x2||top|function||||css|add|||_4|left|||||_a|_d|return|_2|_e|_3|_10|width|_c|this|_55|height|_13|imgAreaSelect|_8|mousemove|_12|document|_1c|_6|unbind|_5|_1|else|false|_58||true|_16|_2c|_21|case|_50|_11|var|resize|_29|_28|test|_3a|opacity|_30|_15|sy|sx|_35|_b|_14|_27|_26|remove|position|body|hide|_1b|_1a|break|_45|_42|mouseup|evY|evX|_1e|_1d|data|enable|disable|_9|one|absolute|zIndex|_17|_f|isNaN|ua|_4a|mousedown|fadeSpeed|_22|_51|classPrefix|keys|_31|_32|resizeMargin|_40|undefined|100|parent|fixed|_36|_2e||_4f|movable|_38|color|addClass|ctrl|shift|extend|_54|altKey|onSelectEnd|onSelectChange|_49|_4c|_19|_18|_3e|_48|_20|_1f|_25|outerWidth|scrollTop|scrollLeft|offset|_24|Math|fn|_4e|is|keyPress|_4b|_4d|_3f|resizable|fadeIn|show|append|borderStyle|background|border|borderWidth|handles|_53|key|switch|alt|arrows|_34|_3c|_41|_44|cursor|_3b|_39|innerWidth|onKeyPress|outerHeight|_2f|_2d|setOptions|src|complete|fontSize||||hidden|visibility|_56|_57|index|length|while|window|match|filter|borderColor|borderColor2|solid|borderColor1|borderOpacity|for|null|_52|default|originalEvent|ctrlKey|shiftKey|onInit|setTimeout|onSelectStart|which|_47|_46|_43|_37|margin|_33|slice|innerHeight|_2b|_2a|jQuery|instance|new|removeData|each|load|img|readyState|overflow|keypress|keydown|on|unselectable|attr|not|chrome||webkit|opera|exec|msie|update|cancelSelection|setSelection|getSelection|getOptions|persistent|split|aspectRatio|dashed|outerOpacity|outerColor|selectionOpacity|selectionColor|selection|outer|imageHeight|imageWidth|parseInt|handle|corners|in|keyCode|imgareaselect|animated|instanceof|visible|preventDefault|autoHide|_3d|toggle|move|mouseout|fadeOut|auto|relative|getBoundingClientRect|jquery|maxHeight|maxWidth|minHeight|minWidth|pageY|pageX|userAgent|navigator|documentElement|div|round|min|max|abs'.split('|')))

/* ! jQuery Form Plugin version: 3.51.0-2014.06.20 Requires jQuery v1.5 or later Copyright (c) 2014 M. Alsup Examples and documentation at: http://malsup.com/jquery/form/ Project repository: https://github.com/malsup/form Dual licensed under the MIT and GPL licenses. https://github.com/malsup/form#copyright-and-license */
/*global ActiveXObject */
// AMD support
(function(factory){"use strict";if(typeof define==='function'&&define.amd){define(['jquery'],factory)}else{factory((typeof(jQuery)!='undefined')?jQuery:window.Zepto)}}(function($){"use strict";var feature={};feature.fileapi=$("<input type='file'/>").get(0).files!==undefined;feature.formdata=window.FormData!==undefined;var hasProp=!!$.fn.prop;$.fn.attr2=function(){if(!hasProp){return this.attr.apply(this,arguments)}var val=this.prop.apply(this,arguments);if((val&&val.jquery)||typeof val==='string'){return val}return this.attr.apply(this,arguments)};$.fn.ajaxSubmit=function(options){if(!this.length){log('ajaxSubmit: skipping submit process - no element selected');return this}var method,action,url,$form=this;if(typeof options=='function'){options={success:options}}else if(options===undefined){options={}}method=options.type||this.attr2('method');action=options.url||this.attr2('action');url=(typeof action==='string')?$.trim(action):'';url=url||window.location.href||'';if(url){url=(url.match(/^([^#]+)/)||[])[1]}options=$.extend(true,{url:url,success:$.ajaxSettings.success,type:method||$.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||'')?'javascript:false':'about:blank'},options);var veto={};this.trigger('form-pre-serialize',[this,options,veto]);if(veto.veto){log('ajaxSubmit: submit vetoed via form-pre-serialize trigger');return this}if(options.beforeSerialize&&options.beforeSerialize(this,options)===false){log('ajaxSubmit: submit aborted via beforeSerialize callback');return this}var traditional=options.traditional;if(traditional===undefined){traditional=$.ajaxSettings.traditional}var elements=[];var qx,a=this.formToArray(options.semantic,elements);if(options.data){options.extraData=options.data;qx=$.param(options.data,traditional)}if(options.beforeSubmit&&options.beforeSubmit(a,this,options)===false){log('ajaxSubmit: submit aborted via beforeSubmit callback');return this}this.trigger('form-submit-validate',[a,this,options,veto]);if(veto.veto){log('ajaxSubmit: submit vetoed via form-submit-validate trigger');return this}var q=$.param(a,traditional);if(qx){q=(q?(q+'&'+qx):qx)}if(options.type.toUpperCase()=='GET'){options.url+=(options.url.indexOf('?')>=0?'&':'?')+q;options.data=null;}else{options.data=q;}var callbacks=[];if(options.resetForm){callbacks.push(function(){$form.resetForm()})}if(options.clearForm){callbacks.push(function(){$form.clearForm(options.includeHidden)})}if(!options.dataType&&options.target){var oldSuccess=options.success||function(){};callbacks.push(function(data){var fn=options.replaceTarget?'replaceWith':'html';$(options.target)[fn](data).each(oldSuccess,arguments)})}else if(options.success){callbacks.push(options.success)}options.success=function(data,status,xhr){var context=options.context||this;for(var i=0,max=callbacks.length;i<max;i+=1){callbacks[i].apply(context,[data,status,xhr||$form,$form])}};if(options.error){var oldError=options.error;options.error=function(xhr,status,error){var context=options.context||this;oldError.apply(context,[xhr,status,error,$form])}}if(options.complete){var oldComplete=options.complete;options.complete=function(xhr,status){var context=options.context||this;oldComplete.apply(context,[xhr,status,$form])}}var fileInputs=$('input[type=file]:enabled',this).filter(function(){return $(this).val()!==''});var hasFileInputs=fileInputs.length>0;var mp='multipart/form-data';var multipart=($form.attr('enctype')==mp||$form.attr('encoding')==mp);var fileAPI=feature.fileapi&&feature.formdata;log("fileAPI :"+fileAPI);var shouldUseFrame=(hasFileInputs||multipart)&&!fileAPI;var jqxhr;if(options.iframe!==false&&(options.iframe||shouldUseFrame)){if(options.closeKeepAlive){$.get(options.closeKeepAlive,function(){jqxhr=fileUploadIframe(a)})}else{jqxhr=fileUploadIframe(a)}}else if((hasFileInputs||multipart)&&fileAPI){jqxhr=fileUploadXhr(a)}else{jqxhr=$.ajax(options)}$form.removeData('jqxhr').data('jqxhr',jqxhr);for(var k=0;k<elements.length;k+=1){elements[k]=null}this.trigger('form-submit-notify',[this,options]);return this;function deepSerialize(extraData){var serialized=$.param(extraData,options.traditional).split('&');var len=serialized.length;var result=[];var i,part;for(i=0;i<len;i+=1){serialized[i]=serialized[i].replace(/\+/g,' ');part=serialized[i].split('=');result.push([decodeURIComponent(part[0]),decodeURIComponent(part[1])])}return result}function fileUploadXhr(a){var formdata=new FormData();for(var i=0;i<a.length;i+=1){formdata.append(a[i].name,a[i].value)}if(options.extraData){var serializedData=deepSerialize(options.extraData);for(i=0;i<serializedData.length;i+=1){if(serializedData[i]){formdata.append(serializedData[i][0],serializedData[i][1])}}}options.data=null;var s=$.extend(true,{},$.ajaxSettings,options,{contentType:false,processData:false,cache:false,type:method||'POST'});if(options.uploadProgress){s.xhr=function(){var xhr=$.ajaxSettings.xhr();if(xhr.upload){xhr.upload.addEventListener('progress',function(event){var percent=0;var position=event.loaded||event.position;var total=event.total;if(event.lengthComputable){percent=Math.ceil(position/total*100)}options.uploadProgress(event,position,total,percent)},false)}return xhr}}s.data=null;var beforeSend=s.beforeSend;s.beforeSend=function(xhr,o){if(options.formData){o.data=options.formData}else{o.data=formdata}if(beforeSend){beforeSend.call(this,xhr,o)}};return $.ajax(s)}function fileUploadIframe(a){var form=$form[0],el,i,s,g,id,$io,io,xhr,sub,n,timedOut,timeoutHandle;var deferred=$.Deferred();deferred.abort=function(status){xhr.abort(status)};if(a){for(i=0;i<elements.length;i+=1){el=$(elements[i]);if(hasProp){el.prop('disabled',false)}else{el.removeAttr('disabled')}}}s=$.extend(true,{},$.ajaxSettings,options);s.context=s.context||s;id='jqFormIO'+(new Date().getTime());if(s.iframeTarget){$io=$(s.iframeTarget);n=$io.attr2('name');if(!n){$io.attr2('name',id)}else{id=n}}else{$io=$('<iframe name="'+id+'" src="'+s.iframeSrc+'" />');$io.css({position:'absolute',top:'-1000px',left:'-1000px'})}io=$io[0];xhr={aborted:0,responseText:null,responseXML:null,status:0,statusText:'n/a',getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(status){var e=(status==='timeout'?'timeout':'aborted');log('aborting upload... '+e);this.aborted=1;try{if(io.contentWindow.document.execCommand){io.contentWindow.document.execCommand('Stop')}}catch(ignore){}$io.attr('src',s.iframeSrc);xhr.error=e;if(s.error){s.error.call(s.context,xhr,e,status)}if(g){$.event.trigger("ajaxError",[xhr,s,e])}if(s.complete){s.complete.call(s.context,xhr,e)}}};g=s.global;if(g&&0===$.active++){$.event.trigger("ajaxStart")}if(g){$.event.trigger("ajaxSend",[xhr,s])}if(s.beforeSend&&s.beforeSend.call(s.context,xhr,s)===false){if(s.global){$.active-=1}deferred.reject();return deferred}if(xhr.aborted){deferred.reject();return deferred}sub=form.clk;if(sub){n=sub.name;if(n&&!sub.disabled){s.extraData=s.extraData||{};s.extraData[n]=sub.value;if(sub.type=="image"){s.extraData[n+'.x']=form.clk_x;s.extraData[n+'.y']=form.clk_y}}}var CLIENT_TIMEOUT_ABORT=1;var SERVER_ABORT=2;function getDoc(frame){var doc=null;try{if(frame.contentWindow){doc=frame.contentWindow.document}}catch(err){log('cannot get iframe.contentWindow document: '+err)}if(doc){return doc}try{doc=frame.contentDocument?frame.contentDocument:frame.document}catch(err){log('cannot get iframe.contentDocument: '+err);doc=frame.document}return doc}var csrf_token=$('meta[name=csrf-token]').attr('content');var csrf_param=$('meta[name=csrf-param]').attr('content');if(csrf_param&&csrf_token){s.extraData=s.extraData||{};s.extraData[csrf_param]=csrf_token}function doSubmit(){var t=$form.attr2('target'),a=$form.attr2('action'),mp='multipart/form-data',et=$form.attr('enctype')||$form.attr('encoding')||mp;form.setAttribute('target',id);if(!method||/post/i.test(method)){form.setAttribute('method','POST')}if(a!=s.url){form.setAttribute('action',s.url)}if(!s.skipEncodingOverride&&(!method||/post/i.test(method))){$form.attr({encoding:'multipart/form-data',enctype:'multipart/form-data'})}if(s.timeout){timeoutHandle=setTimeout(function(){timedOut=true;cb(CLIENT_TIMEOUT_ABORT)},s.timeout)}function checkState(){try{var state=getDoc(io).readyState;log('state = '+state);if(state&&state.toLowerCase()=='uninitialized'){setTimeout(checkState,50)}}catch(e){log('Server abort: ',e,' (',e.name,')');cb(SERVER_ABORT);if(timeoutHandle){clearTimeout(timeoutHandle)}timeoutHandle=undefined}}var extraInputs=[];try{if(s.extraData){for(var n in s.extraData){if(s.extraData.hasOwnProperty(n)){if($.isPlainObject(s.extraData[n])&&s.extraData[n].hasOwnProperty('name')&&s.extraData[n].hasOwnProperty('value')){extraInputs.push($('<input type="hidden" name="'+s.extraData[n].name+'">').val(s.extraData[n].value).appendTo(form)[0])}else{extraInputs.push($('<input type="hidden" name="'+n+'">').val(s.extraData[n]).appendTo(form)[0])}}}}if(!s.iframeTarget){$io.appendTo('body')}if(io.attachEvent){io.attachEvent('onload',cb)}else{io.addEventListener('load',cb,false)}setTimeout(checkState,15);try{form.submit()}catch(err){var submitFn=document.createElement('form').submit;submitFn.apply(form)}}finally{form.setAttribute('action',a);form.setAttribute('enctype',et);if(t){form.setAttribute('target',t)}else{$form.removeAttr('target')}$(extraInputs).remove()}}if(s.forceSync){doSubmit()}else{setTimeout(doSubmit,10);}var data,doc,domCheckCount=50,callbackProcessed;function cb(e){if(xhr.aborted||callbackProcessed){return}doc=getDoc(io);if(!doc){log('cannot access response document');e=SERVER_ABORT}if(e===CLIENT_TIMEOUT_ABORT&&xhr){xhr.abort('timeout');deferred.reject(xhr,'timeout');return}else if(e==SERVER_ABORT&&xhr){xhr.abort('server abort');deferred.reject(xhr,'error','server abort');return}if(!doc||doc.location.href==s.iframeSrc){if(!timedOut){return}}if(io.detachEvent){io.detachEvent('onload',cb)}else{io.removeEventListener('load',cb,false)}var status='success',errMsg;try{if(timedOut){throw 'timeout'}var isXml=s.dataType=='xml'||doc.XMLDocument||$.isXMLDoc(doc);log('isXml='+isXml);if(!isXml&&window.opera&&(doc.body===null||!doc.body.innerHTML)){if(domCheckCount-=1){log('requeing onLoad callback, DOM not available');setTimeout(cb,250);return}}var docRoot=doc.body?doc.body:doc.documentElement;xhr.responseText=docRoot?docRoot.innerHTML:null;xhr.responseXML=doc.XMLDocument?doc.XMLDocument:doc;if(isXml){s.dataType='xml'}xhr.getResponseHeader=function(header){var headers={'content-type':s.dataType};return headers[header.toLowerCase()]};if(docRoot){xhr.status=Number(docRoot.getAttribute('status'))||xhr.status;xhr.statusText=docRoot.getAttribute('statusText')||xhr.statusText}var dt=(s.dataType||'').toLowerCase();var scr=/(json|script|text)/.test(dt);if(scr||s.textarea){var ta=doc.getElementsByTagName('textarea')[0];if(ta){xhr.responseText=ta.value;xhr.status=Number(ta.getAttribute('status'))||xhr.status;xhr.statusText=ta.getAttribute('statusText')||xhr.statusText}else if(scr){var pre=doc.getElementsByTagName('pre')[0];var b=doc.getElementsByTagName('body')[0];if(pre){xhr.responseText=pre.textContent?pre.textContent:pre.innerText}else if(b){xhr.responseText=b.textContent?b.textContent:b.innerText}}}else if(dt=='xml'&&!xhr.responseXML&&xhr.responseText){xhr.responseXML=toXml(xhr.responseText)}try{data=httpData(xhr,dt,s)}catch(err){status='parsererror';xhr.error=errMsg=(err||status)}}catch(err){log('error caught: ',err);status='error';xhr.error=errMsg=(err||status)}if(xhr.aborted){log('upload aborted');status=null}if(xhr.status){status=(xhr.status>=200&&xhr.status<300||xhr.status===304)?'success':'error'}if(status==='success'){if(s.success){s.success.call(s.context,data,'success',xhr)}deferred.resolve(xhr.responseText,'success',xhr);if(g){$.event.trigger("ajaxSuccess",[xhr,s])}}else if(status){if(errMsg===undefined){errMsg=xhr.statusText}if(s.error){s.error.call(s.context,xhr,status,errMsg)}deferred.reject(xhr,'error',errMsg);if(g){$.event.trigger("ajaxError",[xhr,s,errMsg])}}if(g){$.event.trigger("ajaxComplete",[xhr,s])}if(g&&! --$.active){$.event.trigger("ajaxStop")}if(s.complete){s.complete.call(s.context,xhr,status)}callbackProcessed=true;if(s.timeout){clearTimeout(timeoutHandle)}setTimeout(function(){if(!s.iframeTarget){$io.remove()}else{$io.attr('src',s.iframeSrc)}xhr.responseXML=null},100)}var toXml=$.parseXML||function(s,doc){if(window.ActiveXObject){doc=new ActiveXObject('Microsoft.XMLDOM');doc.async='false';doc.loadXML(s)}else{doc=(new DOMParser()).parseFromString(s,'text/xml')}return(doc&&doc.documentElement&&doc.documentElement.nodeName!='parsererror')?doc:null};var parseJSON=$.parseJSON||function(s){return window['eval']('('+s+')')};var httpData=function(xhr,type,s){var ct=xhr.getResponseHeader('content-type')||'',xml=type==='xml'||!type&&ct.indexOf('xml')>=0,data=xml?xhr.responseXML:xhr.responseText;if(xml&&data.documentElement.nodeName==='parsererror'){if($.error){$.error('parsererror')}}if(s&&s.dataFilter){data=s.dataFilter(data,type)}if(typeof data==='string'){if(type==='json'||!type&&ct.indexOf('json')>=0){data=parseJSON(data)}else if(type==="script"||!type&&ct.indexOf("javascript")>=0){$.globalEval(data)}}return data};return deferred}};$.fn.ajaxForm=function(options){options=options||{};options.delegation=options.delegation&&$.isFunction($.fn.on);if(!options.delegation&&this.length===0){var o={s:this.selector,c:this.context};if(!$.isReady&&o.s){log('DOM not ready, queuing ajaxForm');$(function(){$(o.s,o.c).ajaxForm(options)});return this}log('terminating; zero elements found by selector'+($.isReady?'':' (DOM not ready)'));return this}if(options.delegation){$(document).off('submit.form-plugin',this.selector,doAjaxSubmit).off('click.form-plugin',this.selector,captureSubmittingElement).on('submit.form-plugin',this.selector,options,doAjaxSubmit).on('click.form-plugin',this.selector,options,captureSubmittingElement);return this}return this.ajaxFormUnbind().bind('submit.form-plugin',options,doAjaxSubmit).bind('click.form-plugin',options,captureSubmittingElement)};function doAjaxSubmit(e){var options=e.data;if(!e.isDefaultPrevented()){e.preventDefault();$(e.target).ajaxSubmit(options);}}function captureSubmittingElement(e){var target=e.target;var $el=$(target);if(!($el.is("[type=submit],[type=image]"))){var t=$el.closest('[type=submit]');if(t.length===0){return}target=t[0]}var form=this;form.clk=target;if(target.type=='image'){if(e.offsetX!==undefined){form.clk_x=e.offsetX;form.clk_y=e.offsetY}else if(typeof $.fn.offset=='function'){var offset=$el.offset();form.clk_x=e.pageX-offset.left;form.clk_y=e.pageY-offset.top}else{form.clk_x=e.pageX-target.offsetLeft;form.clk_y=e.pageY-target.offsetTop}}setTimeout(function(){form.clk=form.clk_x=form.clk_y=null},100)}$.fn.ajaxFormUnbind=function(){return this.unbind('submit.form-plugin click.form-plugin')};$.fn.formToArray=function(semantic,elements){var a=[];if(this.length===0){return a}var form=this[0];var formId=this.attr('id');var els=semantic?form.getElementsByTagName('*'):form.elements;var els2;if(els&&!/MSIE [678]/.test(navigator.userAgent)){els=$(els).get();}if(formId){els2=$(':input[form="'+formId+'"]').get();if(els2.length){els=(els||[]).concat(els2)}}if(!els||!els.length){return a}var i,j,n,v,el,max,jmax;for(i=0,max=els.length;i<max;i+=1){el=els[i];n=el.name;if(!n||el.disabled){continue}if(semantic&&form.clk&&el.type=="image"){if(form.clk==el){a.push({name:n,value:$(el).val(),type:el.type});a.push({name:n+'.x',value:form.clk_x},{name:n+'.y',value:form.clk_y})}continue}v=$.fieldValue(el,true);if(v&&v.constructor==Array){if(elements){elements.push(el)}for(j=0,jmax=v.length;j<jmax;j+=1){a.push({name:n,value:v[j]})}}else if(feature.fileapi&&el.type=='file'){if(elements){elements.push(el)}var files=el.files;if(files.length){for(j=0;j<files.length;j+=1){a.push({name:n,value:files[j],type:el.type})}}else{a.push({name:n,value:'',type:el.type})}}else if(v!==null&&typeof v!='undefined'){if(elements){elements.push(el)}a.push({name:n,value:v,type:el.type,required:el.required})}}if(!semantic&&form.clk){var $input=$(form.clk),input=$input[0];n=input.name;if(n&&!input.disabled&&input.type=='image'){a.push({name:n,value:$input.val()});a.push({name:n+'.x',value:form.clk_x},{name:n+'.y',value:form.clk_y})}}return a};$.fn.formSerialize=function(semantic){return $.param(this.formToArray(semantic))};$.fn.fieldSerialize=function(successful){var a=[];this.each(function(){var n=this.name;if(!n){return}var v=$.fieldValue(this,successful);if(v&&v.constructor==Array){for(var i=0,max=v.length;i<max;i+=1){a.push({name:n,value:v[i]})}}else if(v!==null&&typeof v!='undefined'){a.push({name:this.name,value:v})}});return $.param(a)};$.fn.fieldValue=function(successful){for(var val=[],i=0,max=this.length;i<max;i+=1){var el=this[i];var v=$.fieldValue(el,successful);if(v===null||typeof v=='undefined'||(v.constructor==Array&&!v.length)){continue}if(v.constructor==Array){$.merge(val,v)}else{val.push(v)}}return val};$.fieldValue=function(el,successful){var n=el.name,t=el.type,tag=el.tagName.toLowerCase();if(successful===undefined){successful=true}if(successful&&(!n||el.disabled||t=='reset'||t=='button'||(t=='checkbox'||t=='radio')&&!el.checked||(t=='submit'||t=='image')&&el.form&&el.form.clk!=el||tag=='select'&&el.selectedIndex==-1)){return null}if(tag=='select'){var index=el.selectedIndex;if(index<0){return null}var a=[],ops=el.options;var one=(t=='select-one');var max=(one?index+1:ops.length);for(var i=(one?index:0);i<max;i+=1){var op=ops[i];if(op.selected){var v=op.value;if(!v){v=(op.attributes&&op.attributes.value&&!(op.attributes.value.specified))?op.text:op.value}if(one){return v}a.push(v)}}return a}return $(el).val()};$.fn.clearForm=function(includeHidden){return this.each(function(){$('input,select,textarea',this).clearFields(includeHidden)})};$.fn.clearFields=$.fn.clearInputs=function(includeHidden){var re=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var t=this.type,tag=this.tagName.toLowerCase();if(re.test(t)||tag=='textarea'){this.value=''}else if(t=='checkbox'||t=='radio'){this.checked=false}else if(tag=='select'){this.selectedIndex=-1}else if(t=="file"){if(/MSIE/.test(navigator.userAgent)){$(this).replaceWith($(this).clone(true))}else{$(this).val('')}}else if(includeHidden){if((includeHidden===true&&/hidden/.test(t))||(typeof includeHidden=='string'&&$(this).is(includeHidden))){this.value=''}}})};$.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=='function'||(typeof this.reset=='object'&&!this.reset.nodeType)){this.reset()}})};$.fn.enable=function(b){if(b===undefined){b=true}return this.each(function(){this.disabled=!b})};$.fn.selected=function(select){if(select===undefined){select=true}return this.each(function(){var t=this.type;if(t=='checkbox'||t=='radio'){this.checked=select}else if(this.tagName.toLowerCase()=='option'){var $sel=$(this).parent('select');if(select&&$sel[0]&&$sel[0].type=='select-one'){$sel.find('option').selected(false)}this.selected=select}})};$.fn.ajaxSubmit.debug=false;function log(){if(!$.fn.ajaxSubmit.debug){return}var msg='[jquery.form] '+Array.prototype.join.call(arguments,'');if(window.console&&window.console.log){window.console.log(msg)}else if(window.opera&&window.opera.postError){window.opera.postError(msg)}}}));